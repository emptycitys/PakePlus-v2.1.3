(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-606ecede","chunk-03e394b4"],{"0e4b":function(t,e,a){"use strict";a("492a")},1:function(t,e){},2:function(t,e){},2396:function(t,e,a){"use strict";t.exports={getImageXml:function(t,e){return('<w:drawing>\n\t\t<wp:inline distT="0" distB="0" distL="0" distR="0">\n\t\t\t<wp:extent cx="'+e[0]+'" cy="'+e[1]+'"/>\n\t\t\t<wp:effectExtent l="0" t="0" r="0" b="0"/>\n\t\t\t<wp:docPr id="2" name="Image 2" descr="image"/>\n\t\t\t<wp:cNvGraphicFramePr>\n\t\t\t\t<a:graphicFrameLocks xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" noChangeAspect="1"/>\n\t\t\t</wp:cNvGraphicFramePr>\n\t\t\t<a:graphic xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main">\n\t\t\t\t<a:graphicData uri="http://schemas.openxmlformats.org/drawingml/2006/picture">\n\t\t\t\t\t<pic:pic xmlns:pic="http://schemas.openxmlformats.org/drawingml/2006/picture">\n\t\t\t\t\t\t<pic:nvPicPr>\n\t\t\t\t\t\t\t<pic:cNvPr id="0" name="Picture 1" descr="image"/>\n\t\t\t\t\t\t\t<pic:cNvPicPr>\n\t\t\t\t\t\t\t\t<a:picLocks noChangeAspect="1" noChangeArrowheads="1"/>\n\t\t\t\t\t\t\t</pic:cNvPicPr>\n\t\t\t\t\t\t</pic:nvPicPr>\n\t\t\t\t\t\t<pic:blipFill>\n\t\t\t\t\t\t\t<a:blip r:embed="rId'+t+'">\n\t\t\t\t\t\t\t\t<a:extLst>\n\t\t\t\t\t\t\t\t\t<a:ext uri="{28A0092B-C50C-407E-A947-70E740481C1C}">\n\t\t\t\t\t\t\t\t\t\t<a14:useLocalDpi xmlns:a14="http://schemas.microsoft.com/office/drawing/2010/main" val="0"/>\n\t\t\t\t\t\t\t\t\t</a:ext>\n\t\t\t\t\t\t\t\t</a:extLst>\n\t\t\t\t\t\t\t</a:blip>\n\t\t\t\t\t\t\t<a:srcRect/>\n\t\t\t\t\t\t\t<a:stretch>\n\t\t\t\t\t\t\t\t<a:fillRect/>\n\t\t\t\t\t\t\t</a:stretch>\n\t\t\t\t\t\t</pic:blipFill>\n\t\t\t\t\t\t<pic:spPr bwMode="auto">\n\t\t\t\t\t\t\t<a:xfrm>\n\t\t\t\t\t\t\t\t<a:off x="0" y="0"/>\n\t\t\t\t\t\t\t\t<a:ext cx="'+e[0]+'" cy="'+e[1]+'"/>\n\t\t\t\t\t\t\t</a:xfrm>\n\t\t\t\t\t\t\t<a:prstGeom prst="rect">\n\t\t\t\t\t\t\t\t<a:avLst/>\n\t\t\t\t\t\t\t</a:prstGeom>\n\t\t\t\t\t\t\t<a:noFill/>\n\t\t\t\t\t\t\t<a:ln>\n\t\t\t\t\t\t\t\t<a:noFill/>\n\t\t\t\t\t\t\t</a:ln>\n\t\t\t\t\t\t</pic:spPr>\n\t\t\t\t\t</pic:pic>\n\t\t\t\t</a:graphicData>\n\t\t\t</a:graphic>\n\t\t</wp:inline>\n\t</w:drawing>\n\t\t').replace(/\t|\n/g,"")},getImageXmlCentered:function(t,e){return('<w:p>\n\t\t\t<w:pPr>\n\t\t\t\t<w:jc w:val="center"/>\n\t\t\t</w:pPr>\n\t\t\t<w:r>\n\t\t\t\t<w:rPr/>\n\t\t\t\t<w:drawing>\n\t\t\t\t\t<wp:inline distT="0" distB="0" distL="0" distR="0">\n\t\t\t\t\t<wp:extent cx="'+e[0]+'" cy="'+e[1]+'"/>\n\t\t\t\t\t<wp:docPr id="0" name="Picture" descr=""/>\n\t\t\t\t\t<a:graphic xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main">\n\t\t\t\t\t\t<a:graphicData uri="http://schemas.openxmlformats.org/drawingml/2006/picture">\n\t\t\t\t\t\t<pic:pic xmlns:pic="http://schemas.openxmlformats.org/drawingml/2006/picture">\n\t\t\t\t\t\t\t<pic:nvPicPr>\n\t\t\t\t\t\t\t<pic:cNvPr id="0" name="Picture" descr=""/>\n\t\t\t\t\t\t\t<pic:cNvPicPr>\n\t\t\t\t\t\t\t\t<a:picLocks noChangeAspect="1" noChangeArrowheads="1"/>\n\t\t\t\t\t\t\t</pic:cNvPicPr>\n\t\t\t\t\t\t\t</pic:nvPicPr>\n\t\t\t\t\t\t\t<pic:blipFill>\n\t\t\t\t\t\t\t<a:blip r:embed="rId'+t+'"/>\n\t\t\t\t\t\t\t<a:stretch>\n\t\t\t\t\t\t\t\t<a:fillRect/>\n\t\t\t\t\t\t\t</a:stretch>\n\t\t\t\t\t\t\t</pic:blipFill>\n\t\t\t\t\t\t\t<pic:spPr bwMode="auto">\n\t\t\t\t\t\t\t<a:xfrm>\n\t\t\t\t\t\t\t\t<a:off x="0" y="0"/>\n\t\t\t\t\t\t\t\t<a:ext cx="'+e[0]+'" cy="'+e[1]+'"/>\n\t\t\t\t\t\t\t</a:xfrm>\n\t\t\t\t\t\t\t<a:prstGeom prst="rect">\n\t\t\t\t\t\t\t\t<a:avLst/>\n\t\t\t\t\t\t\t</a:prstGeom>\n\t\t\t\t\t\t\t<a:noFill/>\n\t\t\t\t\t\t\t<a:ln w="9525">\n\t\t\t\t\t\t\t\t<a:noFill/>\n\t\t\t\t\t\t\t\t<a:miter lim="800000"/>\n\t\t\t\t\t\t\t\t<a:headEnd/>\n\t\t\t\t\t\t\t\t<a:tailEnd/>\n\t\t\t\t\t\t\t</a:ln>\n\t\t\t\t\t\t\t</pic:spPr>\n\t\t\t\t\t\t</pic:pic>\n\t\t\t\t\t\t</a:graphicData>\n\t\t\t\t\t</a:graphic>\n\t\t\t\t\t</wp:inline>\n\t\t\t\t</w:drawing>\n\t\t\t</w:r>\n\t\t</w:p>\n\t\t').replace(/\t|\n/g,"")},getPptxImageXml:function(t,e,a){return('<p:pic>\n\t\t\t<p:nvPicPr>\n\t\t\t\t<p:cNvPr id="6" name="Picture 2"/>\n\t\t\t\t<p:cNvPicPr>\n\t\t\t\t\t<a:picLocks noChangeAspect="1" noChangeArrowheads="1"/>\n\t\t\t\t</p:cNvPicPr>\n\t\t\t\t<p:nvPr/>\n\t\t\t</p:nvPicPr>\n\t\t\t<p:blipFill>\n\t\t\t\t<a:blip r:embed="rId'+t+'" cstate="print">\n\t\t\t\t\t<a:extLst>\n\t\t\t\t\t\t<a:ext uri="{28A0092B-C50C-407E-A947-70E740481C1C}">\n\t\t\t\t\t\t\t<a14:useLocalDpi xmlns:a14="http://schemas.microsoft.com/office/drawing/2010/main" val="0"/>\n\t\t\t\t\t\t</a:ext>\n\t\t\t\t\t</a:extLst>\n\t\t\t\t</a:blip>\n\t\t\t\t<a:srcRect/>\n\t\t\t\t<a:stretch>\n\t\t\t\t\t<a:fillRect/>\n\t\t\t\t</a:stretch>\n\t\t\t</p:blipFill>\n\t\t\t<p:spPr bwMode="auto">\n\t\t\t\t<a:xfrm>\n\t\t\t\t\t<a:off x="'+a.x+'" y="'+a.y+'"/>\n\t\t\t\t\t<a:ext cx="'+e[0]+'" cy="'+e[1]+'"/>\n\t\t\t\t</a:xfrm>\n\t\t\t\t<a:prstGeom prst="rect">\n\t\t\t\t\t<a:avLst/>\n\t\t\t\t</a:prstGeom>\n\t\t\t\t<a:noFill/>\n\t\t\t\t<a:ln>\n\t\t\t\t\t<a:noFill/>\n\t\t\t\t</a:ln>\n\t\t\t\t<a:effectLst/>\n\t\t\t\t<a:extLst>\n\t\t\t\t\t<a:ext uri="{909E8E84-426E-40DD-AFC4-6F175D3DCCD1}">\n\t\t\t\t\t\t<a14:hiddenFill xmlns:a14="http://schemas.microsoft.com/office/drawing/2010/main">\n\t\t\t\t\t\t\t<a:solidFill>\n\t\t\t\t\t\t\t\t<a:schemeClr val="accent1"/>\n\t\t\t\t\t\t\t</a:solidFill>\n\t\t\t\t\t\t</a14:hiddenFill>\n\t\t\t\t\t</a:ext>\n\t\t\t\t\t<a:ext uri="{91240B29-F687-4F45-9708-019B960494DF}">\n\t\t\t\t\t\t<a14:hiddenLine xmlns:a14="http://schemas.microsoft.com/office/drawing/2010/main" w="9525">\n\t\t\t\t\t\t\t<a:solidFill>\n\t\t\t\t\t\t\t\t<a:schemeClr val="tx1"/>\n\t\t\t\t\t\t\t</a:solidFill>\n\t\t\t\t\t\t\t<a:miter lim="800000"/>\n\t\t\t\t\t\t\t<a:headEnd/>\n\t\t\t\t\t\t\t<a:tailEnd/>\n\t\t\t\t\t\t</a14:hiddenLine>\n\t\t\t\t\t</a:ext>\n\t\t\t\t\t<a:ext uri="{AF507438-7753-43E0-B8FC-AC1667EBCBE1}">\n\t\t\t\t\t\t<a14:hiddenEffects xmlns:a14="http://schemas.microsoft.com/office/drawing/2010/main">\n\t\t\t\t\t\t\t<a:effectLst>\n\t\t\t\t\t\t\t\t<a:outerShdw dist="35921" dir="2700000" algn="ctr" rotWithShape="0">\n\t\t\t\t\t\t\t\t\t<a:schemeClr val="bg2"/>\n\t\t\t\t\t\t\t\t</a:outerShdw>\n\t\t\t\t\t\t\t</a:effectLst>\n\t\t\t\t\t\t</a14:hiddenEffects>\n\t\t\t\t\t</a:ext>\n\t\t\t\t</a:extLst>\n\t\t\t</p:spPr>\n\t\t</p:pic>\n\t\t').replace(/\t|\n/g,"")}}},"29d8":function(t,e,a){function n(t){this.options=t||{locator:{}}}function r(t,e,a){if(!t){if(e instanceof l)return e;t=e}var n={},r=t instanceof Function;function i(e){var l=t[e];!l&&r&&(l=2==t.length?function(a){t(e,a)}:t),n[e]=l&&function(t){l("[xmldom "+e+"]\t"+t+o(a))}||function(){}}return a=a||{},i("warning"),i("error"),i("fatalError"),n}function l(){this.cdata=!1}function i(t,e){e.lineNumber=t.lineNumber,e.columnNumber=t.columnNumber}function o(t){if(t)return"\n@"+(t.systemId||"")+"#[line:"+t.lineNumber+",col:"+t.columnNumber+"]"}function s(t,e,a){return"string"==typeof t?t.substr(e,a):t.length>=e+a||e?new java.lang.String(t,e,a)+"":t}function c(t,e){t.currentElement?t.currentElement.appendChild(e):t.doc.appendChild(e)}n.prototype.parseFromString=function(t,e){var a=this.options,n=new u,i=a.domBuilder||new l,o=a.errorHandler,s=a.locator,c=a.xmlns||{},p={lt:"<",gt:">",amp:"&",quot:'"',apos:"'"};return s&&i.setDocumentLocator(s),n.errorHandler=r(o,i,s),n.domBuilder=a.domBuilder||i,/\/x?html?$/.test(e)&&(p.nbsp=" ",p.copy="©",c[""]="http://www.w3.org/1999/xhtml"),c.xml=c.xml||"http://www.w3.org/XML/1998/namespace",t?n.parse(t,c,p):n.errorHandler.error("invalid doc source"),i.doc},l.prototype={startDocument:function(){this.doc=(new p).createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(t,e,a,n){var r=this.doc,l=r.createElementNS(t,a||e),o=n.length;c(this,l),this.currentElement=l,this.locator&&i(this.locator,l);for(var s=0;s<o;s++){t=n.getURI(s);var u=n.getValue(s),p=(a=n.getQName(s),r.createAttributeNS(t,a));this.locator&&i(n.getLocator(s),p),p.value=p.nodeValue=u,l.setAttributeNode(p)}},endElement:function(t,e,a){var n=this.currentElement;n.tagName;this.currentElement=n.parentNode},startPrefixMapping:function(t,e){},endPrefixMapping:function(t){},processingInstruction:function(t,e){var a=this.doc.createProcessingInstruction(t,e);this.locator&&i(this.locator,a),c(this,a)},ignorableWhitespace:function(t,e,a){},characters:function(t,e,a){if(t=s.apply(this,arguments),t){if(this.cdata)var n=this.doc.createCDATASection(t);else n=this.doc.createTextNode(t);this.currentElement?this.currentElement.appendChild(n):/^\s*$/.test(t)&&this.doc.appendChild(n),this.locator&&i(this.locator,n)}},skippedEntity:function(t){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(t){(this.locator=t)&&(t.lineNumber=0)},comment:function(t,e,a){t=s.apply(this,arguments);var n=this.doc.createComment(t);this.locator&&i(this.locator,n),c(this,n)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(t,e,a){var n=this.doc.implementation;if(n&&n.createDocumentType){var r=n.createDocumentType(t,e,a);this.locator&&i(this.locator,r),c(this,r)}},warning:function(t){console.warn("[xmldom warning]\t"+t,o(this.locator))},error:function(t){console.error("[xmldom error]\t"+t,o(this.locator))},fatalError:function(t){throw console.error("[xmldom fatalError]\t"+t,o(this.locator)),t}},"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,(function(t){l.prototype[t]=function(){return null}}));var u=a("d61d").XMLReader,p=e.DOMImplementation=a("749c").DOMImplementation;e.XMLSerializer=a("749c").XMLSerializer,e.DOMParser=n},3:function(t,e){},4:function(t,e){},"492a":function(t,e,a){},5:function(t,e){},6:function(t,e){},"654f":function(t,e,a){"use strict";var n="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r=function(){function t(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,a,n){return a&&t(e.prototype,a),n&&t(e,n),e}}();function l(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=a("2396"),o=a("fbf9").DocUtils,s=a("29d8").DOMParser;function c(t){return!(t===t)}var u=a("e9a3"),p="open-xml-templating/docxtemplater-image-module";function d(t){var e=t.part;return e}function m(t){var e=t.part,a=t.left,n=t.right,r=t.postparsed,l=r.slice(a+1,n).reduce((function(t,e){return t+e.value}),""),i=(new s).parseFromString("<xml>"+l+"</xml>");e.offset={x:0,y:0},e.ext={cx:0,cy:0};var o=i.getElementsByTagName("a:off"),c=i.getElementsByTagName("a:ext");return c.length>0&&(e.ext.cx=parseInt(c[c.length-1].getAttribute("cx"),10),e.ext.cy=parseInt(c[c.length-1].getAttribute("cy"),10)),o.length>0&&(e.offset.x=parseInt(o[o.length-1].getAttribute("x"),10),e.offset.y=parseInt(o[o.length-1].getAttribute("y"),10)),e}var h=function(){function t(e){if(l(this,t),this.name="ImageModule",this.options=e||{},this.imgManagers={},null==this.options.centered&&(this.options.centered=!1),null==this.options.getImage)throw new Error("You should pass getImage");if(null==this.options.getSize)throw new Error("You should pass getSize");this.imageNumber=1}return r(t,[{key:"optionsTransformer",value:function(t,e){var a=e.zip.file(/\.xml\.rels/).concat(e.zip.file(/\[Content_Types\].xml/)).map((function(t){return t.name}));return this.fileTypeConfig=e.fileTypeConfig,this.fileType=e.fileType,this.zip=e.zip,t.xmlFileNames=t.xmlFileNames.concat(a),t}},{key:"set",value:function(t){t.zip&&(this.zip=t.zip),t.xmlDocuments&&(this.xmlDocuments=t.xmlDocuments)}},{key:"parse",value:function(t){var e=p,a="placeholder";return this.options.setParser?this.options.setParser(t):"%%"===t.substring(0,2)?{type:a,value:t.substr(2),module:e,centered:!0}:"%"===t.substring(0,1)?{type:a,value:t.substr(1),module:e,centered:!1}:null}},{key:"postparse",value:function(t){var e=void 0,a=void 0;return"pptx"===this.fileType?(e="p:sp",a=m):(e=this.options.centered?"w:p":"w:t",a=d),o.traits.expandToOne(t,{moduleName:p,getInner:a,expandTo:e})}},{key:"render",value:function(t,e){if("placeholder"===!t.type||t.module!==p)return null;var a=e.scopeManager.getValue(t.value,{part:t});if(!a)return{value:this.fileTypeConfig.tagTextXml};if("object"===("undefined"===typeof a?"undefined":n(a)))return this.getRenderedPart(t,a.rId,a.sizePixel);var r=new u(this.zip,e.filePath,this.xmlDocuments,this.fileType),l=this.options.getImage(a,t.value),i=r.addImageRels(this.getNextImageName(),l),o=this.options.getSize(l,a,t.value);return this.getRenderedPart(t,i,o)}},{key:"resolve",value:function(t,e){var a=this,n=new u(this.zip,e.filePath,this.xmlDocuments,this.fileType);if("placeholder"===!t.type||t.module!==p)return null;var r=e.scopeManager.getValue(t.value,{part:t});return r?new Promise((function(e){var n=a.options.getImage(r,t.value);e(n)})).then((function(e){var l=n.addImageRels(a.getNextImageName(),e);return new Promise((function(n){var l=a.options.getSize(e,r,t.value);n(l)})).then((function(t){return{rId:l,sizePixel:t}}))})):{value:this.fileTypeConfig.tagTextXml}}},{key:"getRenderedPart",value:function(t,e,a){if(c(e))throw new Error("rId is NaN, aborting");var n=[o.convertPixelsToEmus(a[0]),o.convertPixelsToEmus(a[1])],r=this.options.centered||t.centered,l=void 0;return l="pptx"===this.fileType?this.getRenderedPartPptx(t,e,n,r):this.getRenderedPartDocx(e,n,r),{value:l}}},{key:"getRenderedPartPptx",value:function(t,e,a,n){var r={x:parseInt(t.offset.x,10),y:parseInt(t.offset.y,10)},l=parseInt(t.ext.cx,10)||1,o=parseInt(t.ext.cy,10)||1,s=parseInt(a[0],10)||1,c=parseInt(a[1],10)||1;return n&&(r.x=Math.round(r.x+l/2-s/2),r.y=Math.round(r.y+o/2-c/2)),i.getPptxImageXml(e,[s,c],r)}},{key:"getRenderedPartDocx",value:function(t,e,a){return a?i.getImageXmlCentered(t,e):i.getImageXml(t,e)}},{key:"getNextImageName",value:function(){var t="image_generated_"+this.imageNumber+".png";return this.imageNumber++,t}}]),t}();t.exports=h},"6c8a":function(t,e,a){"use strict";a("b0c0"),a("e9c4"),a("b64b");e["a"]={created:function(){var t=this.$store.getters["pageCache/getPageData"](this.$options.name);t&&(Object.assign(this.$data,JSON.parse(JSON.stringify(t))),console.log("恢复缓存：".concat(this.$options.name)))},beforeRouteLeave:function(t,e,a){this.$store.commit("pageCache/saveTempPageData",{page:this.$options.name,data:JSON.parse(JSON.stringify(this.$data))}),console.log("离开页面缓存：".concat(this.$options.name)),a()}}},7:function(t,e){},"749c":function(t,e){function a(t,e){for(var a in t)e[a]=t[a]}function n(t,e){var n=t.prototype;if(Object.create){var r=Object.create(e.prototype);n.__proto__=r}if(!(n instanceof e)){function l(){}l.prototype=e.prototype,l=new l,a(n,l),t.prototype=n=l}n.constructor!=t&&("function"!=typeof t&&console.error("unknow Class:"+t),n.constructor=t)}var r="http://www.w3.org/1999/xhtml",l={},i=l.ELEMENT_NODE=1,o=l.ATTRIBUTE_NODE=2,s=l.TEXT_NODE=3,c=l.CDATA_SECTION_NODE=4,u=l.ENTITY_REFERENCE_NODE=5,p=l.ENTITY_NODE=6,d=l.PROCESSING_INSTRUCTION_NODE=7,m=l.COMMENT_NODE=8,h=l.DOCUMENT_NODE=9,f=l.DOCUMENT_TYPE_NODE=10,b=l.DOCUMENT_FRAGMENT_NODE=11,g=l.NOTATION_NODE=12,w={},D={},v=(w.INDEX_SIZE_ERR=(D[1]="Index size error",1),w.DOMSTRING_SIZE_ERR=(D[2]="DOMString size error",2),w.HIERARCHY_REQUEST_ERR=(D[3]="Hierarchy request error",3)),x=(w.WRONG_DOCUMENT_ERR=(D[4]="Wrong document",4),w.INVALID_CHARACTER_ERR=(D[5]="Invalid character",5),w.NO_DATA_ALLOWED_ERR=(D[6]="No data allowed",6),w.NO_MODIFICATION_ALLOWED_ERR=(D[7]="No modification allowed",7),w.NOT_FOUND_ERR=(D[8]="Not found",8)),y=(w.NOT_SUPPORTED_ERR=(D[9]="Not supported",9),w.INUSE_ATTRIBUTE_ERR=(D[10]="Attribute in use",10));w.INVALID_STATE_ERR=(D[11]="Invalid state",11),w.SYNTAX_ERR=(D[12]="Syntax error",12),w.INVALID_MODIFICATION_ERR=(D[13]="Invalid modification",13),w.NAMESPACE_ERR=(D[14]="Invalid namespace",14),w.INVALID_ACCESS_ERR=(D[15]="Invalid access",15);function B(t,e){if(e instanceof Error)var a=e;else a=this,Error.call(this,D[t]),this.message=D[t],Error.captureStackTrace&&Error.captureStackTrace(this,B);return a.code=t,e&&(this.message=this.message+": "+e),a}function N(){}function C(t,e){this._node=t,this._refresh=e,A(this)}function A(t){var e=t._node._inc||t._node.ownerDocument._inc;if(t._inc!=e){var n=t._refresh(t._node);it(t,"length",n.length),a(n,t),t._inc=e}}function E(){}function k(t,e){var a=t.length;while(a--)if(t[a]===e)return a}function _(t,e,a,n){if(n?e[k(e,n)]=a:e[e.length++]=a,t){a.ownerElement=t;var r=t.ownerDocument;r&&(n&&M(r,t,n),O(r,t,a))}}function P(t,e,a){var n=k(e,a);if(!(n>=0))throw B(x,new Error(t.tagName+"@"+a));var r=e.length-1;while(n<r)e[n]=e[++n];if(e.length=r,t){var l=t.ownerDocument;l&&(M(l,t,a),a.ownerElement=null)}}function T(t){if(this._features={},t)for(var e in t)this._features=t[e]}function S(){}function I(t){return("<"==t?"&lt;":">"==t&&"&gt;")||"&"==t&&"&amp;"||'"'==t&&"&quot;"||"&#"+t.charCodeAt()+";"}function R(t,e){if(e(t))return!0;if(t=t.firstChild)do{if(R(t,e))return!0}while(t=t.nextSibling)}function F(){}function O(t,e,a){t&&t._inc++;var n=a.namespaceURI;"http://www.w3.org/2000/xmlns/"==n&&(e._nsMap[a.prefix?a.localName:""]=a.value)}function M(t,e,a,n){t&&t._inc++;var r=a.namespaceURI;"http://www.w3.org/2000/xmlns/"==r&&delete e._nsMap[a.prefix?a.localName:""]}function $(t,e,a){if(t&&t._inc){t._inc++;var n=e.childNodes;if(a)n[n.length++]=a;else{var r=e.firstChild,l=0;while(r)n[l++]=r,r=r.nextSibling;n.length=l}}}function L(t,e){var a=e.previousSibling,n=e.nextSibling;return a?a.nextSibling=n:t.firstChild=n,n?n.previousSibling=a:t.lastChild=a,$(t.ownerDocument,t),e}function z(t,e,a){var n=e.parentNode;if(n&&n.removeChild(e),e.nodeType===b){var r=e.firstChild;if(null==r)return e;var l=e.lastChild}else r=l=e;var i=a?a.previousSibling:t.lastChild;r.previousSibling=i,l.nextSibling=a,i?i.nextSibling=r:t.firstChild=r,null==a?t.lastChild=l:a.previousSibling=l;do{r.parentNode=t}while(r!==l&&(r=r.nextSibling));return $(t.ownerDocument||t,t),e.nodeType==b&&(e.firstChild=e.lastChild=null),e}function G(t,e){var a=e.parentNode;if(a){var n=t.lastChild;a.removeChild(e);n=t.lastChild}n=t.lastChild;return e.parentNode=t,e.previousSibling=n,e.nextSibling=null,n?n.nextSibling=e:t.firstChild=e,t.lastChild=e,$(t.ownerDocument,t,e),e}function j(){this._nsMap={}}function U(){}function V(){}function W(){}function J(){}function X(){}function H(){}function Y(){}function q(){}function Z(){}function K(){}function Q(){}function tt(){}function et(t,e){var a=[],n=9==this.nodeType?this.documentElement:this,r=n.prefix,l=n.namespaceURI;if(l&&null==r){r=n.lookupPrefix(l);if(null==r)var i=[{namespace:l,prefix:null}]}return nt(this,a,t,e,i),a.join("")}function at(t,e,a){var n=t.prefix||"",r=t.namespaceURI;if(!n&&!r)return!1;if("xml"===n&&"http://www.w3.org/XML/1998/namespace"===r||"http://www.w3.org/2000/xmlns/"==r)return!1;var l=a.length;while(l--){var i=a[l];if(i.prefix==n)return i.namespace!=r}return!0}function nt(t,e,a,n,l){if(n){if(t=n(t),!t)return;if("string"==typeof t)return void e.push(t)}switch(t.nodeType){case i:l||(l=[]);l.length;var p=t.attributes,g=p.length,w=t.firstChild,D=t.tagName;a=r===t.namespaceURI||a,e.push("<",D);for(var v=0;v<g;v++){var x=p.item(v);"xmlns"==x.prefix?l.push({prefix:x.localName,namespace:x.value}):"xmlns"==x.nodeName&&l.push({prefix:"",namespace:x.value})}for(v=0;v<g;v++){x=p.item(v);if(at(x,a,l)){var y=x.prefix||"",B=x.namespaceURI,N=y?" xmlns:"+y:" xmlns";e.push(N,'="',B,'"'),l.push({prefix:y,namespace:B})}nt(x,e,a,n,l)}if(at(t,a,l)){y=t.prefix||"",B=t.namespaceURI,N=y?" xmlns:"+y:" xmlns";e.push(N,'="',B,'"'),l.push({prefix:y,namespace:B})}if(w||a&&!/^(?:meta|link|img|br|hr|input)$/i.test(D)){if(e.push(">"),a&&/^script$/i.test(D))while(w)w.data?e.push(w.data):nt(w,e,a,n,l),w=w.nextSibling;else while(w)nt(w,e,a,n,l),w=w.nextSibling;e.push("</",D,">")}else e.push("/>");return;case h:case b:w=t.firstChild;while(w)nt(w,e,a,n,l),w=w.nextSibling;return;case o:return e.push(" ",t.name,'="',t.value.replace(/[<&"]/g,I),'"');case s:return e.push(t.data.replace(/[<&]/g,I));case c:return e.push("<![CDATA[",t.data,"]]>");case m:return e.push("\x3c!--",t.data,"--\x3e");case f:var C=t.publicId,A=t.systemId;if(e.push("<!DOCTYPE ",t.name),C)e.push(' PUBLIC "',C),A&&"."!=A&&e.push('" "',A),e.push('">');else if(A&&"."!=A)e.push(' SYSTEM "',A,'">');else{var E=t.internalSubset;E&&e.push(" [",E,"]"),e.push(">")}return;case d:return e.push("<?",t.target," ",t.data,"?>");case u:return e.push("&",t.nodeName,";");default:e.push("??",t.nodeName)}}function rt(t,e,a){var n;switch(e.nodeType){case i:n=e.cloneNode(!1),n.ownerDocument=t;case b:break;case o:a=!0;break}if(n||(n=e.cloneNode(!1)),n.ownerDocument=t,n.parentNode=null,a){var r=e.firstChild;while(r)n.appendChild(rt(t,r,a)),r=r.nextSibling}return n}function lt(t,e,a){var n=new e.constructor;for(var r in e){var l=e[r];"object"!=typeof l&&l!=n[r]&&(n[r]=l)}switch(e.childNodes&&(n.childNodes=new N),n.ownerDocument=t,n.nodeType){case i:var s=e.attributes,c=n.attributes=new E,u=s.length;c._ownerElement=n;for(var p=0;p<u;p++)n.setAttributeNode(lt(t,s.item(p),!0));break;case o:a=!0}if(a){var d=e.firstChild;while(d)n.appendChild(lt(t,d,a)),d=d.nextSibling}return n}function it(t,e,a){t[e]=a}B.prototype=Error.prototype,a(w,B),N.prototype={length:0,item:function(t){return this[t]||null},toString:function(t,e){for(var a=[],n=0;n<this.length;n++)nt(this[n],a,t,e);return a.join("")}},C.prototype.item=function(t){return A(this),this[t]},n(C,N),E.prototype={length:0,item:N.prototype.item,getNamedItem:function(t){var e=this.length;while(e--){var a=this[e];if(a.nodeName==t)return a}},setNamedItem:function(t){var e=t.ownerElement;if(e&&e!=this._ownerElement)throw new B(y);var a=this.getNamedItem(t.nodeName);return _(this._ownerElement,this,t,a),a},setNamedItemNS:function(t){var e,a=t.ownerElement;if(a&&a!=this._ownerElement)throw new B(y);return e=this.getNamedItemNS(t.namespaceURI,t.localName),_(this._ownerElement,this,t,e),e},removeNamedItem:function(t){var e=this.getNamedItem(t);return P(this._ownerElement,this,e),e},removeNamedItemNS:function(t,e){var a=this.getNamedItemNS(t,e);return P(this._ownerElement,this,a),a},getNamedItemNS:function(t,e){var a=this.length;while(a--){var n=this[a];if(n.localName==e&&n.namespaceURI==t)return n}return null}},T.prototype={hasFeature:function(t,e){var a=this._features[t.toLowerCase()];return!(!a||e&&!(e in a))},createDocument:function(t,e,a){var n=new F;if(n.implementation=this,n.childNodes=new N,n.doctype=a,a&&n.appendChild(a),e){var r=n.createElementNS(t,e);n.appendChild(r)}return n},createDocumentType:function(t,e,a){var n=new H;return n.name=t,n.nodeName=t,n.publicId=e,n.systemId=a,n}},S.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(t,e){return z(this,t,e)},replaceChild:function(t,e){this.insertBefore(t,e),e&&this.removeChild(e)},removeChild:function(t){return L(this,t)},appendChild:function(t){return this.insertBefore(t,null)},hasChildNodes:function(){return null!=this.firstChild},cloneNode:function(t){return lt(this.ownerDocument||this,this,t)},normalize:function(){var t=this.firstChild;while(t){var e=t.nextSibling;e&&e.nodeType==s&&t.nodeType==s?(this.removeChild(e),t.appendData(e.data)):(t.normalize(),t=e)}},isSupported:function(t,e){return this.ownerDocument.implementation.hasFeature(t,e)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(t){var e=this;while(e){var a=e._nsMap;if(a)for(var n in a)if(a[n]==t)return n;e=e.nodeType==o?e.ownerDocument:e.parentNode}return null},lookupNamespaceURI:function(t){var e=this;while(e){var a=e._nsMap;if(a&&t in a)return a[t];e=e.nodeType==o?e.ownerDocument:e.parentNode}return null},isDefaultNamespace:function(t){var e=this.lookupPrefix(t);return null==e}},a(l,S),a(l,S.prototype),F.prototype={nodeName:"#document",nodeType:h,doctype:null,documentElement:null,_inc:1,insertBefore:function(t,e){if(t.nodeType==b){var a=t.firstChild;while(a){var n=a.nextSibling;this.insertBefore(a,e),a=n}return t}return null==this.documentElement&&t.nodeType==i&&(this.documentElement=t),z(this,t,e),t.ownerDocument=this,t},removeChild:function(t){return this.documentElement==t&&(this.documentElement=null),L(this,t)},importNode:function(t,e){return rt(this,t,e)},getElementById:function(t){var e=null;return R(this.documentElement,(function(a){if(a.nodeType==i&&a.getAttribute("id")==t)return e=a,!0})),e},createElement:function(t){var e=new j;e.ownerDocument=this,e.nodeName=t,e.tagName=t,e.childNodes=new N;var a=e.attributes=new E;return a._ownerElement=e,e},createDocumentFragment:function(){var t=new K;return t.ownerDocument=this,t.childNodes=new N,t},createTextNode:function(t){var e=new W;return e.ownerDocument=this,e.appendData(t),e},createComment:function(t){var e=new J;return e.ownerDocument=this,e.appendData(t),e},createCDATASection:function(t){var e=new X;return e.ownerDocument=this,e.appendData(t),e},createProcessingInstruction:function(t,e){var a=new Q;return a.ownerDocument=this,a.tagName=a.target=t,a.nodeValue=a.data=e,a},createAttribute:function(t){var e=new U;return e.ownerDocument=this,e.name=t,e.nodeName=t,e.localName=t,e.specified=!0,e},createEntityReference:function(t){var e=new Z;return e.ownerDocument=this,e.nodeName=t,e},createElementNS:function(t,e){var a=new j,n=e.split(":"),r=a.attributes=new E;return a.childNodes=new N,a.ownerDocument=this,a.nodeName=e,a.tagName=e,a.namespaceURI=t,2==n.length?(a.prefix=n[0],a.localName=n[1]):a.localName=e,r._ownerElement=a,a},createAttributeNS:function(t,e){var a=new U,n=e.split(":");return a.ownerDocument=this,a.nodeName=e,a.name=e,a.namespaceURI=t,a.specified=!0,2==n.length?(a.prefix=n[0],a.localName=n[1]):a.localName=e,a}},n(F,S),j.prototype={nodeType:i,hasAttribute:function(t){return null!=this.getAttributeNode(t)},getAttribute:function(t){var e=this.getAttributeNode(t);return e&&e.value||""},getAttributeNode:function(t){return this.attributes.getNamedItem(t)},setAttribute:function(t,e){var a=this.ownerDocument.createAttribute(t);a.value=a.nodeValue=""+e,this.setAttributeNode(a)},removeAttribute:function(t){var e=this.getAttributeNode(t);e&&this.removeAttributeNode(e)},appendChild:function(t){return t.nodeType===b?this.insertBefore(t,null):G(this,t)},setAttributeNode:function(t){return this.attributes.setNamedItem(t)},setAttributeNodeNS:function(t){return this.attributes.setNamedItemNS(t)},removeAttributeNode:function(t){return this.attributes.removeNamedItem(t.nodeName)},removeAttributeNS:function(t,e){var a=this.getAttributeNodeNS(t,e);a&&this.removeAttributeNode(a)},hasAttributeNS:function(t,e){return null!=this.getAttributeNodeNS(t,e)},getAttributeNS:function(t,e){var a=this.getAttributeNodeNS(t,e);return a&&a.value||""},setAttributeNS:function(t,e,a){var n=this.ownerDocument.createAttributeNS(t,e);n.value=n.nodeValue=""+a,this.setAttributeNode(n)},getAttributeNodeNS:function(t,e){return this.attributes.getNamedItemNS(t,e)},getElementsByTagName:function(t){return new C(this,(function(e){var a=[];return R(e,(function(n){n===e||n.nodeType!=i||"*"!==t&&n.tagName!=t||a.push(n)})),a}))},getElementsByTagNameNS:function(t,e){return new C(this,(function(a){var n=[];return R(a,(function(r){r===a||r.nodeType!==i||"*"!==t&&r.namespaceURI!==t||"*"!==e&&r.localName!=e||n.push(r)})),n}))}},F.prototype.getElementsByTagName=j.prototype.getElementsByTagName,F.prototype.getElementsByTagNameNS=j.prototype.getElementsByTagNameNS,n(j,S),U.prototype.nodeType=o,n(U,S),V.prototype={data:"",substringData:function(t,e){return this.data.substring(t,t+e)},appendData:function(t){t=this.data+t,this.nodeValue=this.data=t,this.length=t.length},insertData:function(t,e){this.replaceData(t,0,e)},appendChild:function(t){throw new Error(D[v])},deleteData:function(t,e){this.replaceData(t,e,"")},replaceData:function(t,e,a){var n=this.data.substring(0,t),r=this.data.substring(t+e);a=n+a+r,this.nodeValue=this.data=a,this.length=a.length}},n(V,S),W.prototype={nodeName:"#text",nodeType:s,splitText:function(t){var e=this.data,a=e.substring(t);e=e.substring(0,t),this.data=this.nodeValue=e,this.length=e.length;var n=this.ownerDocument.createTextNode(a);return this.parentNode&&this.parentNode.insertBefore(n,this.nextSibling),n}},n(W,V),J.prototype={nodeName:"#comment",nodeType:m},n(J,V),X.prototype={nodeName:"#cdata-section",nodeType:c},n(X,V),H.prototype.nodeType=f,n(H,S),Y.prototype.nodeType=g,n(Y,S),q.prototype.nodeType=p,n(q,S),Z.prototype.nodeType=u,n(Z,S),K.prototype.nodeName="#document-fragment",K.prototype.nodeType=b,n(K,S),Q.prototype.nodeType=d,n(Q,S),tt.prototype.serializeToString=function(t,e,a){return et.call(t,e,a)},S.prototype.toString=et;try{if(Object.defineProperty){function ot(t){switch(t.nodeType){case i:case b:var e=[];t=t.firstChild;while(t)7!==t.nodeType&&8!==t.nodeType&&e.push(ot(t)),t=t.nextSibling;return e.join("");default:return t.nodeValue}}Object.defineProperty(C.prototype,"length",{get:function(){return A(this),this.$$length}}),Object.defineProperty(S.prototype,"textContent",{get:function(){return ot(this)},set:function(t){switch(this.nodeType){case i:case b:while(this.firstChild)this.removeChild(this.firstChild);(t||String(t))&&this.appendChild(this.ownerDocument.createTextNode(t));break;default:this.data=t,this.value=t,this.nodeValue=t}}}),it=function(t,e,a){t["$$"+e]=a}}}catch(st){}e.DOMImplementation=T,e.XMLSerializer=tt},8:function(t,e){},9:function(t,e){},9608:function(t,e,a){"use strict";(function(t){var n=a("c14f"),r=a("1da1"),l=a("2909"),i=a("5530"),o=(a("99af"),a("cb29"),a("d81d"),a("b0c0"),a("a9e3"),a("8ba4"),a("b680"),a("d3b7"),a("ac1f"),a("25f0"),a("3ca3"),a("5319"),a("0643"),a("a573"),a("ddb0"),a("1146")),s=a("313e"),c=a("cc45"),u=a("547c"),p=a.n(u),d=a("fbf9"),m=a.n(d),h=a("654f"),f=a.n(h),b=a("21a6"),g=a("6c8a");e["a"]={name:"Page15A",components:{PdfViewer:c["default"]},mixins:[g["a"]],data:function(){return{showPdf:!1,pdfName:"",chartImage:null,autoWidth:!0,bookType:"xlsx",tableData1:[{B4:14.5,B5:.03,B6:0,B7:0,B8:0,B9:0,B10:0,B11:0,B3:null,B14:null,B15:null,B16:0,B17:0,B18:null,B20:null,B21:null,B22:null,B23:0,B24:0,B25:null,B27:0,B28:null,B29:null,B30:null,B31:null,B33:25,B34:18,B35:40}],tableData2:[{A:0,B:73.5},{A:2,B:83.5},{A:4,B:98},{A:8,B:144},{A:12,B:282.35}],tableData3:[{A:0,B:61.12055006},{A:2,B:69.94561576},{A:4,B:81.77110757},{A:6,B:98.45854561},{A:8,B:123.8362953},{A:10,B:167.2922026},{A:13,B:363.0381842}],tableData4:[],tableData5:[],dialogVisible:!1,newRow:{A:"",B:""},dialogVisible3:!1,newRow3:{A:"",B:""}}},mounted:function(){this.load(),this.change()},methods:{formatNumber:function(t){return"number"===typeof t?Number.isInteger(t)?t.toString():t.toFixed(3):t},downloadSample:function(){var t="/templates//input_sample.xls",e=document.createElement("a");e.href=t,e.download="筒形基础沉贯计算导入模板.xlsx",document.body.appendChild(e),e.click(),document.body.removeChild(e)},uploadExcel:function(t){var e=this,a=t.target.files[0];if(a){var n=new FileReader;n.onload=function(t){var a=t.target.result,n=o["read"](a,{type:"binary"}),r=n.SheetNames[0],l=n.Sheets[r],i=o["utils"].sheet_to_json(l);e.tableData4=i.map((function(t){return{D:null!=t["土层名称"]?t["土层名称"]:"",E:null!=t["土层性质(砂土1，黏土2)"]?t["土层性质(砂土1，黏土2)"]:"",F:null!=t["层号(地勘-)"]?t["层号(地勘-)"]:"",G:null!=t["z下沉深度/m"]?t["z下沉深度/m"]:"",H:null!=t["自重/MN"]?t["自重/MN"]:"",I:null!=t["qc平均锥尖阻力/kpa(勘察报告给)"]?t["qc平均锥尖阻力/kpa(勘察报告给)"]:"",J:null!=t["γ‘浮重度/kN·m-3"]?t["γ‘浮重度/kN·m-3"]:"",K:null!=t["c粘聚力/kPa"]?t["c粘聚力/kPa"]:"",L:null!=t["φ内摩擦角/°"]?t["φ内摩擦角/°"]:"",M:null!=t["St灵敏度（2~3）"]?t["St灵敏度（2~3）"]:"",O:null!=t["Nc（黏土算端阻，建议值7.5）"]?t["Nc（黏土算端阻，建议值7.5）"]:"",P:null!=t["kp端阻系数（推荐值）"]?t["kp端阻系数（推荐值）"]:"",Q:null!=t["kf侧阻力系数（推荐值）"]?t["kf侧阻力系数（推荐值）"]:"",R:null!=t["kp端阻系数（最大值）"]?t["kp端阻系数（最大值）"]:"",S:null!=t["kf侧阻力系数（最大值）"]?t["kf侧阻力系数（最大值）"]:""}})),e.$message.success("Excel 数据导入成功！"),e.$refs.excelInput.value="",console.log("上传后的数据:",e.tableData4);for(var s=0,c=0,u=0,p=0,d=0,m=0;m<e.tableData4.length;m++)e.tableData4[m].D=1===e.tableData4[m].E?" 砂土 ":2===e.tableData4[m].E?" 黏土 ":e.tableData4[m].D,e.tableData4[m].N=1===e.tableData4[m].E?0:2===e.tableData4[m].E?0===m?60:60+4*e.tableData4[m].G/3.7:e.tableData4[m].N,e.tableData4[m].T=0===m?0:(e.tableData4[m].G-e.tableData4[m-1].G)*e.tableData1[0].B13*e.tableData4[m].Q*e.tableData4[m].I,e.tableData4[m].U=e.tableData4[m].P*e.tableData1[0].B25*e.tableData4[m].I,s+=e.tableData4[m].T,e.tableData4[m].V=1*(s+e.tableData4[m].U),e.tableData4[m].W=Math.max((e.tableData4[m].V-1e3*e.tableData4[m].H)/e.tableData1[0].B31,0),e.tableData4[m].Y=0===m?0:(e.tableData4[m].G-e.tableData4[m-1].G)*e.tableData1[0].B13*e.tableData4[m].S*e.tableData4[m].I,e.tableData4[m].Z=0===m?0:e.tableData4[m].R*e.tableData1[0].B25*e.tableData4[m].I,c+=e.tableData4[m].Y,e.tableData4[m].AA=0===m?0:1*(c+e.tableData4[m].Z),e.tableData4[m].AB=Math.max((e.tableData4[m].AA-1e3*e.tableData4[m].H)/e.tableData1[0].B31,0),e.tableData4[m].AD=0===m?e.tableData4[m].J*e.tableData4[m].G:e.tableData4[m].J*(e.tableData4[m].G-e.tableData4[m-1].G)+e.tableData4[m-1].AD,e.tableData4[m].AE=0===m?e.tableData1[0].B13*e.tableData4[m].G:e.tableData1[0].B13*(e.tableData4[m].G-e.tableData4[m-1].G),e.tableData4[m].AF=0===m?0:e.tableData4[m].AE*e.tableData4[m].N*(1/e.tableData4[m].M),u+=e.tableData4[m].AF,e.tableData4[m].AG=0===m?0:u,e.tableData4[m].AI=e.tableData4[m].O*e.tableData4[m].N+e.tableData4[m].J*e.tableData4[m].G,e.tableData4[m].AJ=e.tableData4[m].AI*e.tableData1[0].B25,e.tableData4[m].AL=0===m?e.tableData4[m].T:u,e.tableData4[m].AM=1===e.tableData4[m].E?e.tableData4[m].U:e.tableData4[m].AJ,e.tableData4[m].AN=e.tableData4[m].AL+e.tableData4[m].AM,e.tableData4[m].AO=Math.max((e.tableData4[m].AN-1e3*e.tableData4[m].H)/e.tableData1[0].B31,0),e.tableData4[m].AQ=6.2*(1+.34*Math.atan(e.tableData4[m].G/parseFloat(e.tableData1[0].B4))),e.tableData4[m].AR=e.tableData4[m].N,e.tableData4[m].AS=e.tableData4[m].AR,e.tableData4[m].AT=(e.tableData1[0].B13/2+e.tableData1[0].B14+e.tableData1[0].B15+parseFloat(e.tableData1[0].B17)+parseFloat(e.tableData1[0].B16))*e.tableData4[m].G,e.tableData4[0].AU=e.tableData1[0].B31,e.tableData4[m].AV=e.tableData4[m].M,e.tableData4[m].AX=1/e.tableData4[m].AV,e.tableData4[m].AY=2/3*e.tableData4[m].AR,e.tableData4[m].AZ=0===m?0:e.tableData4[m-1].AZ+(e.tableData4[m].AT-e.tableData4[m-1].AT)*e.tableData4[m].AX*e.tableData4[m].AR,e.tableData4[m].BA=e.tableData4[m].AQ*e.tableData4[m].AY+e.tableData4[m].AZ/e.tableData4[0].AU,e.tableData4[m].BC=1.32*Math.pow(e.tableData4[m].G/parseFloat(e.tableData1[0].B4),.75)*parseFloat(e.tableData1[0].B4)*e.tableData4[m].J,e.tableData4[m].BE=1===e.tableData4[m].E?e.tableData4[m].BC:e.tableData4[m].BA,e.tableData4[m].BF=Math.max(10*(parseFloat(e.tableData1[0].B33)-parseFloat(e.tableData1[0].B34)+e.tableData4[m].G)+parseFloat(e.tableData1[0].B35)<0?0:10*(parseFloat(e.tableData1[0].B33)-parseFloat(e.tableData1[0].B34)+e.tableData4[m].G)+parseFloat(e.tableData1[0].B35)),e.tableData4[m].BG=(100+10*(parseFloat(e.tableData1[0].B33)+e.tableData4[m].G-parseFloat(e.tableData1[0].B34)))/1.25,e.tableData4[m].BI=.8*e.tableData4[m].AD*Math.tan(.9*Math.PI*e.tableData4[m].L/180),e.tableData4[m].BJ=m<2?e.tableData1[0].B13*e.tableData4[m].G:e.tableData1[0].B13*(e.tableData4[m].G-e.tableData4[m-1].G),e.tableData4[m].BK=0===m?0:e.tableData4[m].BJ*e.tableData4[m].BI,p+=e.tableData4[m].BK,e.tableData4[m].BL=p,e.tableData4[m].BM=Math.pow(2.71828,3.1415926*Math.tan(Math.PI*e.tableData4[m].L/180))*Math.pow(Math.tan(Math.PI*(45+e.tableData4[m].L/2)/180),2),e.tableData4[m].BN=1.5*(e.tableData4[m].BM-1)*Math.tan(Math.PI*e.tableData4[m].L/180),e.tableData4[m].BO=e.tableData4[m].BM*(1+.8*Math.tan(.9*Math.PI*e.tableData4[m].L/180))*e.tableData4[m].AD+.5*e.tableData4[m].J*parseFloat(e.tableData1[0].B5)*e.tableData4[m].BN,e.tableData4[m].BP=e.tableData4[m].BO*e.tableData1[0].B25,e.tableData4[m].BQ=e.tableData4[m].H,e.tableData4[m].BT=e.tableData4[m].G,e.tableData4[m].BU=e.tableData4[m].J,e.tableData4[m].BV=e.tableData4[m].AD,e.tableData4[m].BW=e.tableData4[m].M,e.tableData4[m].BX=e.tableData4[m].N,e.tableData4[m].BY=e.tableData4[m].H,e.tableData4[m].BZ=e.tableData4[m].AE,e.tableData4[m].CA=0===m?0:e.tableData4[m].BZ*e.tableData4[m].BX*(1/e.tableData4[m].BW),d+=e.tableData4[m].CA,e.tableData4[m].CB=0===m?0:d,e.tableData4[m].CC=e.tableData4[m].O,e.tableData4[m].CD=e.tableData4[m].CC*e.tableData4[m].BX+e.tableData4[m].BV,e.tableData4[m].CE=e.tableData4[m].CD*e.tableData1[0].B25,e.tableData4[m].CH=0===m?e.tableData4[m].BL:e.tableData4[m].CB,e.tableData4[m].CI=1===e.tableData4[m].E?e.tableData4[m].BP:e.tableData4[m].CE,e.tableData4[m].CJ=e.tableData4[m].CH+e.tableData4[m].CI,e.tableData4[m].CK=Math.max((e.tableData4[m].CJ-1e3*e.tableData4[m].BQ)/e.tableData1[0].B31,0);e.tableData5=e.tableData4.map((function(t){return{D:t.D,G:t.G,W:t.W,AB:t.AB,AO:t.AO,BE:t.BE,BF:t.BF,BG:t.BG,CK:t.CK}})),console.log("表5数据:",e.tableData5)},n.readAsBinaryString(a)}else this.$message.warning("请先选择文件！")},openDialog:function(){this.newRow={A:"",B:""},this.dialogVisible=!0},addRow:function(){""!==this.newRow.A&&""!==this.newRow.B?(this.tableData2.push(Object(i["a"])({},this.newRow)),this.tableData4&&this.tableData4.length>0&&this.drawChart(),this.dialogVisible=!1):this.$message.warning("请输入完整数据")},openDialog3:function(){this.newRow3={A:"",B:""},this.dialogVisible3=!0},addRow3:function(){""!==this.newRow3.A&&""!==this.newRow3.B?(this.tableData3.push(Object(i["a"])({},this.newRow3)),this.tableData4&&this.tableData4.length>0&&this.drawChart(),this.dialogVisible3=!1):this.$message.warning("请输入完整数据")},drawChart:function(){var t=this;if(this.tableData4&&0!==this.tableData4.length){var e=this.tableData2.map((function(t){var e;return Number(null!==(e=t.A)&&void 0!==e?e:0)})),a=this.tableData2.map((function(t){var e;return Number(null!==(e=t.B)&&void 0!==e?e:0)})),n=this.tableData3.map((function(t){var e;return Number(null!==(e=t.A)&&void 0!==e?e:0)})),r=this.tableData3.map((function(t){var e;return Number(null!==(e=t.B)&&void 0!==e?e:0)})),i=[{name:"渗透破坏+土塞隆起临界压差",key:"BE"},{name:"可用压差",key:"BF"},{name:"空化控制",key:"BG"}],o=[{name:"CPT-推荐值",key:"W"},{name:"CPT-最大值",key:"AB"},{name:"砂CPT推荐值+黏su",key:"AO"},{name:"砂土φ+黏土su",key:"CK"}],c=document.getElementById("chartContainer"),u=s["init"](c),p={title:{text:"",left:"center"},tooltip:{trigger:"axis"},legend:{top:30,type:"plain",orient:"horizontal",width:"80%",itemWidth:20,itemHeight:10,itemGap:12,textStyle:{fontSize:12},data:[].concat(Object(l["a"])(i.map((function(t){return t.name}))),Object(l["a"])(o.map((function(t){return t.name}))),["屈曲临界压差-有限元","屈曲临界压差-规范"])},grid:{top:90,left:60,right:40,bottom:40},xAxis:{type:"value",name:"压差 / kPa",axisLabel:{formatter:"{value}"}},yAxis:{type:"value",name:"下沉深度 / m"},series:[].concat(Object(l["a"])(i.map((function(e){return{name:e.name,type:"line",symbol:"none",smooth:!0,lineStyle:{type:"dashed"},data:t.tableData4.map((function(t){var a,n;return[Number(null!==(a=t[e.key])&&void 0!==a?a:0),Number(null!==(n=t.G)&&void 0!==n?n:0)]}))}}))),Object(l["a"])(o.map((function(e){return{name:e.name,type:"line",symbol:"none",smooth:!0,data:t.tableData4.map((function(t){var a,n;return[Number(null!==(a=t[e.key])&&void 0!==a?a:0),Number(null!==(n=t.G)&&void 0!==n?n:0)]}))}}))),[{name:"屈曲临界压差-有限元",type:"line",symbol:"diamond",lineStyle:{type:"dashed"},itemStyle:{color:"#FF5722"},data:a.map((function(t,n){return[a[n],e[n]]}))},{name:"屈曲临界压差-规范",type:"line",symbol:"triangle",lineStyle:{type:"dotted"},itemStyle:{color:"#3F51B5"},data:r.map((function(t,e){return[r[e],n[e]]}))}])};u.setOption(p),window.addEventListener("resize",(function(){u.resize()})),setTimeout((function(){t.chartImage=u.getDataURL({type:"png",pixelRatio:2,backgroundColor:"#ffffff"})}),800)}else this.$message.warning("请先上传数据！")},change:function(){this.load(),this.tableData4&&this.tableData4.length>0&&this.drawChart()},load:function(){this.tableData1[0].B13=Math.PI*parseFloat(this.tableData1[0].B4)*2,this.tableData1[0].B14=2*parseFloat(this.tableData1[0].B6)*6,this.tableData1[0].B15=2*parseFloat(this.tableData1[0].B8)*6,this.tableData1[0].B18=this.tableData1[0].B13+this.tableData1[0].B14+this.tableData1[0].B15+parseFloat(this.tableData1[0].B16)+parseFloat(this.tableData1[0].B17),this.tableData1[0].B20=Math.PI*parseFloat(this.tableData1[0].B4)*parseFloat(this.tableData1[0].B5),this.tableData1[0].B21=parseFloat(this.tableData1[0].B7)*parseFloat(this.tableData1[0].B6)*6,this.tableData1[0].B22=parseFloat(this.tableData1[0].B9)*parseFloat(this.tableData1[0].B8)*6,this.tableData1[0].B25=this.tableData1[0].B20+this.tableData1[0].B21+parseFloat(this.tableData1[0].B23)+this.tableData1[0].B22+parseFloat(this.tableData1[0].B24),this.tableData1[0].B28=this.tableData1[0].B25+parseFloat(this.tableData1[0].B27),this.tableData1[0].B31=Math.PI*Math.pow(parseFloat(this.tableData1[0].B4)/2,2)},exportExcel:function(){var t=this;Promise.all([a.e("chunk-113f5141"),a.e("chunk-2d0cc0b6")]).then(a.bind(null,"4bf8")).then((function(e){if(t.tableData4&&0!==t.tableData4.length){var a=[["有限元屈计算限值曲线（限值曲线4）","","","","","","","",""]],n=["无支长度（有限元屈计算）/m","屈曲压差/kPa"],r=["A","B"],i=t.formatJson(r,t.tableData2),o=["A1:B1"],s=Array(n.length).fill(""),c=[["有限元屈计算限值曲线（限值曲线5）","",""]],u=["无支长度（规范屈曲计算）/m","屈曲压差/kPa"],p=["A","B"],d=t.formatJson(p,t.tableData3),m=t.tableData2.length+4,h=["A".concat(m,":B").concat(m)],f=[["","","设计曲线","","","","压差限值曲线","",""]],b=["土层名称","Z/下沉深度/m","CPT推荐值 压差/kPa","CPT最大值 压差/kPa","砂土CPT+黏土Su 需要压差/kPa","强度指标法 需要压差/kPa","砂土渗透+黏土土塞压差/kpa","可用压差/kPa","空化控制压差"],g=["D","G","W","AB","AO","CK","BE","BF","BG"],w=t.formatJson(g,t.tableData5),D=t.tableData2.length+t.tableData3.length+7,v=["C".concat(D,":F").concat(D),"G".concat(D,":I").concat(D)],x=[].concat(a),y=[].concat(n),B=[].concat(o,h,v),N=[].concat(Object(l["a"])(i),[s],c,[u],Object(l["a"])(d),[s],f,[b],Object(l["a"])(w)),C=t.filename||"筒形基础沉贯计算（HE）";e.export_json_to_excel({multiHeader:x,header:y,merges:B,data:N,filename:C,autoWidth:t.autoWidth,bookType:t.bookType})}else t.$message.warning("请先上传数据！")}))},formatJson:function(t,e){return e.map((function(e){return t.map((function(t){return e[t]}))}))},handleExportWord:function(){var e=this;return Object(r["a"])(Object(n["a"])().m((function a(){var r,l,o,s,c,u,d,h,g,w,D,v,x;return Object(n["a"])().w((function(a){while(1)switch(a.p=a.n){case 0:if(e.chartImage){a.n=1;break}return e.$message.warning('请先点击"绘制折线图"生成图表后再导出！'),a.a(2);case 1:for(d in r=new Date,l=r.getFullYear(),o=r.getMonth()+1,s=r.getDate(),c=Object(i["a"])(Object(i["a"])({},e.tableData1[0]),{},{year:l,month:o,day:s}),u={},c)u[d]=e.formatNumber(c[d]);return u.chartImage=e.chartImage,a.n=2,fetch("/templates/1_15.docx").then((function(t){return t.arrayBuffer()}));case 2:h=a.v,g=new p.a(h),w=new f.a({centered:!0,getImage:function(e){return t.from(e.replace(/^data:image\/\w+;base64,/,""),"base64")},getSize:function(){return[600,400]}}),D=new m.a(g,{modules:[w]}),D.setData(u),a.p=3,D.render(),a.n=5;break;case 4:throw a.p=4,x=a.v,console.error("模板渲染失败",x),x;case 5:v=D.getZip().generate({type:"blob",mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"}),Object(b["saveAs"])(v,"筒形基础沉贯计算计算书.docx");case 6:return a.a(2)}}),a,null,[[3,4]])})))()},JumpToPdf:function(){console.log("pdf跳转"),this.pdfName="1_15",this.showPdf=!0}}}}).call(this,a("b639").Buffer)},"99fa":function(t,e,a){"use strict";var n=a("fbf9").DocUtils;n.convertPixelsToEmus=function(t){return Math.round(9525*t)},t.exports=n},cc45:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"pdf-viewer"},[a("div",{staticClass:"controls"},[a("button",{attrs:{disabled:t.pageNum<=1},on:{click:t.prevPage}},[t._v("上一页")]),a("span",[t._v("第 "+t._s(t.pageNum)+" / "+t._s(t.totalPages)+" 页")]),a("button",{attrs:{disabled:t.pageNum>=t.totalPages},on:{click:t.nextPage}},[t._v("下一页")]),a("button",{on:{click:t.zoomOut}},[t._v("缩小")]),a("span",[t._v("缩放: "+t._s((100*t.scale).toFixed(0))+"%")]),a("button",{on:{click:t.zoomIn}},[t._v("放大")]),a("button",{on:{click:function(e){return t.$emit("close")}}},[t._v("关闭")])]),a("canvas",{ref:"pdfCanvas"})])},r=[],l=a("c14f"),i=a("1da1"),o=a("f9cb"),s=a("8658"),c=a.n(s);o["GlobalWorkerOptions"].workerSrc=c.a;var u={name:"PdfViewer",props:{pdfName:{type:String,required:!0}},data:function(){return{pdfDoc:null,pageNum:1,totalPages:0,scale:1}},watch:{pdfName:"loadPdf"},mounted:function(){this.loadPdf()},methods:{loadPdf:function(){var t=this;return Object(i["a"])(Object(l["a"])().m((function e(){var a,n;return Object(l["a"])().w((function(e){while(1)switch(e.p=e.n){case 0:return a="/pdf/".concat(t.pdfName,".pdf"),e.p=1,e.n=2,o["getDocument"](a).promise;case 2:t.pdfDoc=e.v,t.totalPages=t.pdfDoc.numPages,t.pageNum=1,t.renderPage(),e.n=4;break;case 3:e.p=3,n=e.v,console.error("加载 PDF 出错:",n);case 4:return e.a(2)}}),e,null,[[1,3]])})))()},renderPage:function(){var t=this;return Object(i["a"])(Object(l["a"])().m((function e(){var a,n,r,i,o;return Object(l["a"])().w((function(e){while(1)switch(e.n){case 0:return e.n=1,t.pdfDoc.getPage(t.pageNum);case 1:return a=e.v,n=a.getViewport({scale:t.scale}),r=t.$refs.pdfCanvas,i=r.getContext("2d"),r.height=n.height,r.width=n.width,o={canvasContext:i,viewport:n},e.n=2,a.render(o).promise;case 2:return e.a(2)}}),e)})))()},prevPage:function(){this.pageNum>1&&(this.pageNum--,this.renderPage())},nextPage:function(){this.pageNum<this.totalPages&&(this.pageNum++,this.renderPage())},zoomIn:function(){this.scale+=.2,this.renderPage()},zoomOut:function(){this.scale>.4&&(this.scale-=.2,this.renderPage())}}},p=u,d=(a("0e4b"),a("2877")),m=Object(d["a"])(p,n,r,!1,null,"73facc5c",null);e["default"]=m.exports},d61d:function(t,e){var a=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,n=new RegExp("[\\-\\.0-9"+a.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),r=new RegExp("^"+a.source+n.source+"*(?::"+a.source+n.source+"*)?$"),l=0,i=1,o=2,s=3,c=4,u=5,p=6,d=7;function m(){}function h(t,e,a,n,r){function l(t){if(t>65535){t-=65536;var e=55296+(t>>10),a=56320+(1023&t);return String.fromCharCode(e,a)}return String.fromCharCode(t)}function i(t){var e=t.slice(1,-1);return e in a?a[e]:"#"===e.charAt(0)?l(parseInt(e.substr(1).replace("x","0x"))):(r.error("entity not found:"+t),t)}function o(e){if(e>v){var a=t.substring(v,e).replace(/&#?\w+;/g,i);d&&s(v),n.characters(a,0,e-v),v=e}}function s(e,a){while(e>=u&&(a=p.exec(t)))c=a.index,u=c+a[0].length,d.lineNumber++;d.columnNumber=e-c+1}var c=0,u=0,p=/.*(?:\r\n?|\n)|.*$/g,d=n.locator,m=[{currentNSMap:e}],h={},v=0;while(1){try{var N=t.indexOf("<",v);if(N<0){if(!t.substr(v).match(/^\s*$/)){var C=n.doc,A=C.createTextNode(t.substr(v));C.appendChild(A),n.currentElement=A}return}switch(N>v&&o(N),t.charAt(N+1)){case"/":var E=t.indexOf(">",N+3),k=t.substring(N+2,E),_=m.pop();E<0?(k=t.substring(N+2).replace(/[\s<].*/,""),r.error("end tag name: "+k+" is not complete:"+_.tagName),E=N+1+k.length):k.match(/\s</)&&(k=k.replace(/[\s<].*/,""),r.error("end tag name: "+k+" maybe not complete"),E=N+1+k.length);var P=_.localNSMap,T=_.tagName==k,S=T||_.tagName&&_.tagName.toLowerCase()==k.toLowerCase();if(S){if(n.endElement(_.uri,_.localName,k),P)for(var I in P)n.endPrefixMapping(I);T||r.fatalError("end tag name: "+k+" is not match the current start tagName:"+_.tagName)}else m.push(_);E++;break;case"?":d&&s(N),E=y(t,N,n);break;case"!":d&&s(N),E=x(t,N,n,r);break;default:d&&s(N);var R=new B,F=m[m.length-1].currentNSMap,O=(E=b(t,N,R,F,i,r),R.length);if(!R.closed&&D(t,E,R.tagName,h)&&(R.closed=!0,a.nbsp||r.warning("unclosed xml attribute")),d&&O){for(var M=f(d,{}),$=0;$<O;$++){var L=R[$];s(L.offset),L.locator=f(d,{})}n.locator=M,g(R,n,F)&&m.push(R),n.locator=d}else g(R,n,F)&&m.push(R);"http://www.w3.org/1999/xhtml"!==R.uri||R.closed?E++:E=w(t,E,R.tagName,i,n)}}catch(z){r.error("element parse error: "+z),E=-1}E>v?v=E:o(Math.max(N,v)+1)}}function f(t,e){return e.lineNumber=t.lineNumber,e.columnNumber=t.columnNumber,e}function b(t,e,a,n,r,m){var h,f=++e,b=l;while(1){var g=t.charAt(f);switch(g){case"=":if(b===i)h=t.slice(e,f),b=s;else{if(b!==o)throw new Error("attribute equal must after attrName");b=s}break;case"'":case'"':if(b===s||b===i){if(b===i&&(m.warning('attribute value must after "="'),h=t.slice(e,f)),e=f+1,f=t.indexOf(g,e),!(f>0))throw new Error("attribute value no end '"+g+"' match");w=t.slice(e,f).replace(/&#?\w+;/g,r),a.add(h,w,e-1),b=u}else{if(b!=c)throw new Error('attribute value must after "="');w=t.slice(e,f).replace(/&#?\w+;/g,r),a.add(h,w,e),m.warning('attribute "'+h+'" missed start quot('+g+")!!"),e=f+1,b=u}break;case"/":switch(b){case l:a.setTagName(t.slice(e,f));case u:case p:case d:b=d,a.closed=!0;case c:case i:case o:break;default:throw new Error("attribute invalid close char('/')")}break;case"":return m.error("unexpected end of input"),b==l&&a.setTagName(t.slice(e,f)),f;case">":switch(b){case l:a.setTagName(t.slice(e,f));case u:case p:case d:break;case c:case i:w=t.slice(e,f),"/"===w.slice(-1)&&(a.closed=!0,w=w.slice(0,-1));case o:b===o&&(w=h),b==c?(m.warning('attribute "'+w+'" missed quot(")!!'),a.add(h,w.replace(/&#?\w+;/g,r),e)):("http://www.w3.org/1999/xhtml"===n[""]&&w.match(/^(?:disabled|checked|selected)$/i)||m.warning('attribute "'+w+'" missed value!! "'+w+'" instead!!'),a.add(w,w,e));break;case s:throw new Error("attribute value missed!!")}return f;case"":g=" ";default:if(g<=" ")switch(b){case l:a.setTagName(t.slice(e,f)),b=p;break;case i:h=t.slice(e,f),b=o;break;case c:var w=t.slice(e,f).replace(/&#?\w+;/g,r);m.warning('attribute "'+w+'" missed quot(")!!'),a.add(h,w,e);case u:b=p;break}else switch(b){case o:a.tagName;"http://www.w3.org/1999/xhtml"===n[""]&&h.match(/^(?:disabled|checked|selected)$/i)||m.warning('attribute "'+h+'" missed value!! "'+h+'" instead2!!'),a.add(h,h,e),e=f,b=i;break;case u:m.warning('attribute space is required"'+h+'"!!');case p:b=i,e=f;break;case s:b=c,e=f;break;case d:throw new Error("elements closed character '/' and '>' must be connected to")}}f++}}function g(t,e,a){var n=t.tagName,r=null,l=t.length;while(l--){var i=t[l],o=i.qName,s=i.value,c=o.indexOf(":");if(c>0)var u=i.prefix=o.slice(0,c),p=o.slice(c+1),d="xmlns"===u&&p;else p=o,u=null,d="xmlns"===o&&"";i.localName=p,!1!==d&&(null==r&&(r={},v(a,a={})),a[d]=r[d]=s,i.uri="http://www.w3.org/2000/xmlns/",e.startPrefixMapping(d,s))}l=t.length;while(l--){i=t[l];u=i.prefix;u&&("xml"===u&&(i.uri="http://www.w3.org/XML/1998/namespace"),"xmlns"!==u&&(i.uri=a[u||""]))}c=n.indexOf(":");c>0?(u=t.prefix=n.slice(0,c),p=t.localName=n.slice(c+1)):(u=null,p=t.localName=n);var m=t.uri=a[u||""];if(e.startElement(m,p,n,t),!t.closed)return t.currentNSMap=a,t.localNSMap=r,!0;if(e.endElement(m,p,n),r)for(u in r)e.endPrefixMapping(u)}function w(t,e,a,n,r){if(/^(?:script|textarea)$/i.test(a)){var l=t.indexOf("</"+a+">",e),i=t.substring(e+1,l);if(/[&<]/.test(i))return/^script$/i.test(a)?(r.characters(i,0,i.length),l):(i=i.replace(/&#?\w+;/g,n),r.characters(i,0,i.length),l)}return e+1}function D(t,e,a,n){var r=n[a];return null==r&&(r=t.lastIndexOf("</"+a+">"),r<e&&(r=t.lastIndexOf("</"+a)),n[a]=r),r<e}function v(t,e){for(var a in t)e[a]=t[a]}function x(t,e,a,n){var r=t.charAt(e+2);switch(r){case"-":if("-"===t.charAt(e+3)){var l=t.indexOf("--\x3e",e+4);return l>e?(a.comment(t,e+4,l-e-4),l+3):(n.error("Unclosed comment"),-1)}return-1;default:if("CDATA["==t.substr(e+3,6)){l=t.indexOf("]]>",e+9);return a.startCDATA(),a.characters(t,e+9,l-e-9),a.endCDATA(),l+3}var i=C(t,e),o=i.length;if(o>1&&/!doctype/i.test(i[0][0])){var s=i[1][0],c=o>3&&/^public$/i.test(i[2][0])&&i[3][0],u=o>4&&i[4][0],p=i[o-1];return a.startDTD(s,c&&c.replace(/^(['"])(.*?)\1$/,"$2"),u&&u.replace(/^(['"])(.*?)\1$/,"$2")),a.endDTD(),p.index+p[0].length}}return-1}function y(t,e,a){var n=t.indexOf("?>",e);if(n){var r=t.substring(e,n).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);if(r){r[0].length;return a.processingInstruction(r[1],r[2]),n+2}return-1}return-1}function B(t){}function N(t,e){return t.__proto__=e,t}function C(t,e){var a,n=[],r=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;r.lastIndex=e,r.exec(t);while(a=r.exec(t))if(n.push(a),a[1])return n}m.prototype={parse:function(t,e,a){var n=this.domBuilder;n.startDocument(),v(e,e={}),h(t,e,a,n,this.errorHandler),n.endDocument()}},B.prototype={setTagName:function(t){if(!r.test(t))throw new Error("invalid tagName:"+t);this.tagName=t},add:function(t,e,a){if(!r.test(t))throw new Error("invalid attribute:"+t);this[this.length++]={qName:t,value:e,offset:a}},length:0,getLocalName:function(t){return this[t].localName},getLocator:function(t){return this[t].locator},getQName:function(t){return this[t].qName},getURI:function(t){return this[t].uri},getValue:function(t){return this[t].value}},N({},N.prototype)instanceof N||(N=function(t,e){function a(){}for(e in a.prototype=e,a=new a,t)a[e]=t[e];return a}),e.XMLReader=m},e138:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{"background-color":"#f5f7fa",padding:"20px","border-radius":"8px"}},[a("div",{staticStyle:{"margin-bottom":"20px"}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-download"},on:{click:t.downloadSample}},[t._v("下载样例数据")]),a("el-button",{attrs:{type:"primary",icon:"el-icon-document"},on:{click:function(e){return t.$refs.excelInput.click()}}},[t._v("上传数据")]),a("input",{ref:"excelInput",staticStyle:{display:"none"},attrs:{type:"file",accept:".xlsx, .xls"},on:{change:t.uploadExcel}}),a("el-button",{attrs:{type:"primary",icon:"el-icon-data-analysis"},on:{click:t.drawChart}},[t._v("绘制折线图")]),a("el-button",{attrs:{type:"primary",icon:"el-icon-document"},on:{click:t.exportExcel}},[t._v("导出表格数据")]),a("el-button",{attrs:{type:"primary",icon:"el-icon-document"},on:{click:t.handleExportWord}},[t._v("生成计算书")])],1),a("div",{staticClass:"custom-card"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData1,border:"",stripe:"","header-cell-style":{background:"#f5f7fa",color:"#4e4b4b",fontWeight:"bold"}}},[a("el-table-column",{attrs:{label:"基本输入参数","header-align":"center",align:"center"}},[a("el-table-column",{attrs:{prop:"B4",label:"筒直径DO/m","header-align":"center",align:"center","min-width":"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.$index<=1?a("div",{staticClass:"editable-cell"},[a("el-input",{staticClass:"centered-input",attrs:{placeholder:"",size:"small"},on:{input:t.change},model:{value:e.row.B4,callback:function(a){t.$set(e.row,"B4",a)},expression:"scope.row.B4"}})],1):a("div",{staticClass:"readonly-cell"},[t._v(" "+t._s(e.row.B4)+" ")])]}}])},[a("template",{slot:"header"},[a("span",{domProps:{innerHTML:t._s("筒直径D<sub>O</sub>/m")}})])],2),a("el-table-column",{attrs:{prop:"B5",label:"筒壁厚t/m","header-align":"center",align:"center","min-width":"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.$index<=1?a("div",{staticClass:"editable-cell"},[a("el-input",{staticClass:"centered-input",attrs:{placeholder:"",size:"small"},on:{input:t.change},model:{value:e.row.B5,callback:function(a){t.$set(e.row,"B5",a)},expression:"scope.row.B5"}})],1):a("div",{staticClass:"readonly-cell"},[t._v(" "+t._s(e.row.B5)+" ")])]}}])}),a("el-table-column",{attrs:{prop:"B6",label:"分舱板长度/m","header-align":"center",align:"center","min-width":"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.$index<=1?a("div",{staticClass:"editable-cell"},[a("el-input",{staticClass:"centered-input",attrs:{placeholder:"",size:"small"},on:{input:t.change},model:{value:e.row.B6,callback:function(a){t.$set(e.row,"B6",a)},expression:"scope.row.B6"}})],1):a("div",{staticClass:"readonly-cell"},[t._v(" "+t._s(e.row.B6)+" ")])]}}])}),a("el-table-column",{attrs:{prop:"B7",label:"分舱板壁厚/m","header-align":"center",align:"center","min-width":"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.$index<=1?a("div",{staticClass:"editable-cell"},[a("el-input",{staticClass:"centered-input",attrs:{placeholder:"",size:"small"},on:{input:t.change},model:{value:e.row.B7,callback:function(a){t.$set(e.row,"B7",a)},expression:"scope.row.B7"}})],1):a("div",{staticClass:"readonly-cell"},[t._v(" "+t._s(e.row.B7)+" ")])]}}])}),a("el-table-column",{attrs:{prop:"B8",label:"内舱板长度/m","header-align":"center",align:"center","min-width":"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.$index<=1?a("div",{staticClass:"editable-cell"},[a("el-input",{staticClass:"centered-input",attrs:{placeholder:"",size:"small"},on:{input:t.change},model:{value:e.row.B8,callback:function(a){t.$set(e.row,"B8",a)},expression:"scope.row.B8"}})],1):a("div",{staticClass:"readonly-cell"},[t._v(" "+t._s(e.row.B8)+" ")])]}}])}),a("el-table-column",{attrs:{prop:"B9",label:"分舱板壁厚/m","header-align":"center",align:"center","min-width":"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.$index<=1?a("div",{staticClass:"editable-cell"},[a("el-input",{staticClass:"centered-input",attrs:{placeholder:"",size:"small"},on:{input:t.change},model:{value:e.row.B9,callback:function(a){t.$set(e.row,"B9",a)},expression:"scope.row.B9"}})],1):a("div",{staticClass:"readonly-cell"},[t._v(" "+t._s(e.row.B9)+" ")])]}}])})],1)],1),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData1,border:"",stripe:"","header-cell-style":{background:"#f5f7fa",color:"#4e4b4b",fontWeight:"bold"}}},[a("el-table-column",{attrs:{prop:"B10",label:"通长加劲肋长度/m","header-align":"center",align:"center","min-width":"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.$index<=1?a("div",{staticClass:"editable-cell"},[a("el-input",{staticClass:"centered-input",attrs:{placeholder:"",size:"small"},on:{input:t.change},model:{value:e.row.B10,callback:function(a){t.$set(e.row,"B10",a)},expression:"scope.row.B10"}})],1):a("div",{staticClass:"readonly-cell"},[t._v(" "+t._s(e.row.B10)+" ")])]}}])}),a("el-table-column",{attrs:{prop:"B11",label:"通长加劲肋壁厚/m","header-align":"center",align:"center","min-width":"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.$index<=1?a("div",{staticClass:"editable-cell"},[a("el-input",{staticClass:"centered-input",attrs:{placeholder:"",size:"small"},on:{input:t.change},model:{value:e.row.B11,callback:function(a){t.$set(e.row,"B11",a)},expression:"scope.row.B11"}})],1):a("div",{staticClass:"readonly-cell"},[t._v(" "+t._s(e.row.B11)+" ")])]}}])}),a("el-table-column",{attrs:{prop:"B33",label:"水深/m","header-align":"center",align:"center","min-width":"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.$index<=1?a("div",{staticClass:"editable-cell"},[a("el-input",{staticClass:"centered-input",attrs:{placeholder:"",size:"small"},on:{input:t.change},model:{value:e.row.B33,callback:function(a){t.$set(e.row,"B33",a)},expression:"scope.row.B33"}})],1):a("div",{staticClass:"readonly-cell"},[t._v(" "+t._s(e.row.B33)+" ")])]}}])}),a("el-table-column",{attrs:{prop:"B34",label:"筒高/m","header-align":"center",align:"center","min-width":"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.$index<=1?a("div",{staticClass:"editable-cell"},[a("el-input",{staticClass:"centered-input",attrs:{placeholder:"",size:"small"},on:{input:t.change},model:{value:e.row.B34,callback:function(a){t.$set(e.row,"B34",a)},expression:"scope.row.B34"}})],1):a("div",{staticClass:"readonly-cell"},[t._v(" "+t._s(e.row.B34)+" ")])]}}])}),a("el-table-column",{attrs:{prop:"B35",label:"泵能提供的大气压/kpa","header-align":"center",align:"center","min-width":"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.$index<=1?a("div",{staticClass:"editable-cell"},[a("el-input",{staticClass:"centered-input",attrs:{placeholder:"",size:"small"},on:{input:t.change},model:{value:e.row.B35,callback:function(a){t.$set(e.row,"B35",a)},expression:"scope.row.B35"}})],1):a("div",{staticClass:"readonly-cell"},[t._v(" "+t._s(e.row.B35)+" ")])]}}])})],1),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData1,border:"",stripe:"","header-cell-style":{background:"#f5f7fa",color:"#4e4b4b",fontWeight:"bold"}}},[a("el-table-column",{attrs:{label:"单位高度的筒侧面积/m²","header-align":"center",align:"center"}},[a("el-table-column",{attrs:{prop:"B13",label:"单位高度筒壁面积/m²","header-align":"center",align:"center","min-width":"120",formatter:function(e){return t.formatNumber(e.B13)}}}),a("el-table-column",{attrs:{prop:"B14",label:"单位面积高度分舱板面积/m²","header-align":"center",align:"center","min-width":"120",formatter:function(e){return t.formatNumber(e.B14)}}}),a("el-table-column",{attrs:{prop:"B15",label:"单位面积高度内舱板面积/m²","header-align":"center",align:"center","min-width":"120",formatter:function(e){return t.formatNumber(e.B15)}}}),a("el-table-column",{attrs:{prop:"B16",label:"单位面积高度筒内桩面积/m²","header-align":"center",align:"center","min-width":"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.$index<=1?a("div",{staticClass:"editable-cell"},[a("el-input",{staticClass:"centered-input",attrs:{placeholder:"",size:"small"},on:{input:t.change},model:{value:e.row.B16,callback:function(a){t.$set(e.row,"B16",a)},expression:"scope.row.B16"}})],1):a("div",{staticClass:"readonly-cell"},[t._v(" "+t._s(e.row.B16)+" ")])]}}])}),a("el-table-column",{attrs:{prop:"B17",label:"单位面积高度通长加筋肋面积/m²","header-align":"center",align:"center","min-width":"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.$index<=1?a("div",{staticClass:"editable-cell"},[a("el-input",{staticClass:"centered-input",attrs:{placeholder:"",size:"small"},on:{input:t.change},model:{value:e.row.B17,callback:function(a){t.$set(e.row,"B17",a)},expression:"scope.row.B17"}})],1):a("div",{staticClass:"readonly-cell"},[t._v(" "+t._s(e.row.B17)+" ")])]}}])}),a("el-table-column",{attrs:{prop:"B18",label:"总单位高度侧面积/m²","header-align":"center",align:"center","min-width":"120",formatter:function(e){return t.formatNumber(e.B18)}}})],1)],1),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData1,border:"",stripe:"","header-cell-style":{background:"#f5f7fa",color:"#4e4b4b",fontWeight:"bold"}}},[a("el-table-column",{attrs:{label:"筒端面积/m²","header-align":"center",align:"center"}},[a("el-table-column",{attrs:{prop:"B20",label:"筒壁端面积/m²","header-align":"center",align:"center",formatter:function(e){return t.formatNumber(e.B20)},"min-width":"120"}}),a("el-table-column",{attrs:{prop:"B21",label:"分舱板端面积/m²","header-align":"center",align:"center","min-width":"120",formatter:function(e){return t.formatNumber(e.B21)}}}),a("el-table-column",{attrs:{prop:"B22",label:"分舱板端面积/m²","header-align":"center",align:"center","min-width":"120",formatter:function(e){return t.formatNumber(e.B22)}}}),a("el-table-column",{attrs:{prop:"B23",label:"筒内桩端面积/m²","header-align":"center",align:"center","min-width":"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.$index<=1?a("div",{staticClass:"editable-cell"},[a("el-input",{staticClass:"centered-input",attrs:{placeholder:"",size:"small"},on:{input:t.change},model:{value:e.row.B23,callback:function(a){t.$set(e.row,"B23",a)},expression:"scope.row.B23"}})],1):a("div",{staticClass:"readonly-cell"},[t._v(" "+t._s(e.row.B23)+" ")])]}}])}),a("el-table-column",{attrs:{prop:"B24",label:"通长加劲肋端面积/m²","header-align":"center",align:"center","min-width":"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.$index<=1?a("div",{staticClass:"editable-cell"},[a("el-input",{staticClass:"centered-input",attrs:{placeholder:"",size:"small"},on:{input:t.change},model:{value:e.row.B24,callback:function(a){t.$set(e.row,"B24",a)},expression:"scope.row.B24"}})],1):a("div",{staticClass:"readonly-cell"},[t._v(" "+t._s(e.row.B24)+" ")])]}}])}),a("el-table-column",{attrs:{prop:"B25",label:"总端面积/m²","header-align":"center",align:"center","min-width":"120",formatter:function(e){return t.formatNumber(e.B25)}}})],1)],1),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData1,border:"",stripe:"","header-cell-style":{background:"#f5f7fa",color:"#4e4b4b",fontWeight:"bold"}}},[a("el-table-column",{attrs:{label:"总端面积和顶盖面积/m²","header-align":"center",align:"center"}},[a("el-table-column",{attrs:{prop:"B27",label:"减阻环增加的端面积/m²","header-align":"center",align:"center","min-width":"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.$index<=1?a("div",{staticClass:"editable-cell"},[a("el-input",{staticClass:"centered-input",attrs:{placeholder:"",size:"small"},on:{input:t.change},model:{value:e.row.B27,callback:function(a){t.$set(e.row,"B27",a)},expression:"scope.row.B27"}})],1):a("div",{staticClass:"readonly-cell"},[t._v(" "+t._s(e.row.B27)+" ")])]}}])}),a("el-table-column",{attrs:{prop:"B28",label:"减阻环+总端面积/m²","header-align":"center",align:"center","min-width":"120",formatter:function(e){return t.formatNumber(e.B28)}}}),a("el-table-column",{attrs:{prop:"B31",label:"顶盖面积/m²","header-align":"center",align:"center","min-width":"120",formatter:function(e){return t.formatNumber(e.B31)}}})],1)],1)],1),a("div",[a("el-button",{staticStyle:{margin:"20px 0"},attrs:{type:"primary",icon:"el-icon-circle-plus"},on:{click:t.openDialog}},[t._v(" 新增单元行 ")]),a("div",{staticClass:"custom-card"},[a("el-table",{attrs:{data:t.tableData2,border:"",stripe:"","header-cell-style":{background:"#f5f7fa",color:"#4e4b4b",fontWeight:"bold"}}},[a("el-table-column",{attrs:{label:"有限元屈计算限值曲线（限值曲线4）","header-align":"center",align:"center"}},[a("el-table-column",{attrs:{prop:"A",label:"无支长度（有限元屈计算）/m","header-align":"center",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input",{staticClass:"centered-input",attrs:{placeholder:"",size:"small"},on:{input:t.change},model:{value:e.row.A,callback:function(a){t.$set(e.row,"A",a)},expression:"scope.row.A"}})]}}])}),a("el-table-column",{attrs:{prop:"B",label:"屈曲压差/kPa","header-align":"center",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input",{staticClass:"centered-input",attrs:{placeholder:"",size:"small"},on:{input:t.change},model:{value:e.row.B,callback:function(a){t.$set(e.row,"B",a)},expression:"scope.row.B"}})]}}])})],1)],1)],1),a("el-dialog",{attrs:{title:"有限元屈计算限值曲线（限值曲线4） 新增单元行",visible:t.dialogVisible,width:"450px"},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("el-form",{attrs:{model:t.newRow,"label-width":"250px"}},[a("el-form-item",{attrs:{label:"有限元屈计算限值曲线（限值曲线4）"}},[a("el-input",{model:{value:t.newRow.A,callback:function(e){t.$set(t.newRow,"A",e)},expression:"newRow.A"}})],1),a("el-form-item",{attrs:{label:"屈曲压差/kPa"}},[a("el-input",{model:{value:t.newRow.B,callback:function(e){t.$set(t.newRow,"B",e)},expression:"newRow.B"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.addRow}},[t._v("确定")])],1)],1)],1),a("div",[a("el-button",{staticStyle:{margin:"10px 0"},attrs:{type:"primary",icon:"el-icon-circle-plus"},on:{click:t.openDialog3}},[t._v(" 新增单元行 ")]),a("div",{staticClass:"custom-card"},[a("el-table",{attrs:{data:t.tableData3,border:"",stripe:"","header-cell-style":{background:"#f5f7fa",color:"#4e4b4b",fontWeight:"bold"}}},[a("el-table-column",{attrs:{label:"有限元屈计算限值曲线（限值曲线5）","header-align":"center",align:"center"}},[a("el-table-column",{attrs:{prop:"A",label:"无支长度（规范屈曲计算）/m","header-align":"center",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input",{staticClass:"centered-input",attrs:{placeholder:"",size:"small"},on:{input:t.change},model:{value:e.row.A,callback:function(a){t.$set(e.row,"A",a)},expression:"scope.row.A"}})]}}])}),a("el-table-column",{attrs:{prop:"B",label:"屈曲压差/kPa","header-align":"center",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input",{staticClass:"centered-input",attrs:{placeholder:"",size:"small"},on:{input:t.change},model:{value:e.row.B,callback:function(a){t.$set(e.row,"B",a)},expression:"scope.row.B"}})]}}])})],1)],1)],1),a("el-dialog",{attrs:{title:"有限元屈计算限值曲线（限值曲线5） 新增单元行",visible:t.dialogVisible3,width:"450px"},on:{"update:visible":function(e){t.dialogVisible3=e}}},[a("el-form",{attrs:{model:t.newRow3,"label-width":"250px"}},[a("el-form-item",{attrs:{label:"无支长度（规范屈曲计算）/m"}},[a("el-input",{model:{value:t.newRow3.A,callback:function(e){t.$set(t.newRow3,"A",e)},expression:"newRow3.A"}})],1),a("el-form-item",{attrs:{label:"屈曲压差/kPa"}},[a("el-input",{model:{value:t.newRow3.B,callback:function(e){t.$set(t.newRow3,"B",e)},expression:"newRow3.B"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogVisible3=!1}}},[t._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.addRow3}},[t._v("确定")])],1)],1)],1),a("div",{staticClass:"custom-card"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData5,border:"",stripe:"",height:"1000","header-cell-style":{background:"#f5f7fa",color:"#4e4b4b",fontWeight:"bold"}}},[a("el-table-column",{attrs:{prop:"D",label:"土层名称","header-align":"center",align:"center",formatter:function(e){return t.formatNumber(e.D)},width:"80"}}),a("el-table-column",{attrs:{prop:"G",label:"z下沉深度/m","header-align":"center",align:"center",formatter:function(e){return t.formatNumber(e.G)}}}),a("el-table-column",{attrs:{label:"设计曲线","header-align":"center",align:"center"}},[a("el-table-column",{attrs:{prop:"W",label:"CPT推荐值 压差/kPa","header-align":"center",align:"center",formatter:function(e){return t.formatNumber(e.W)}}}),a("el-table-column",{attrs:{prop:"AB",label:"CPT最大值 压差/kPa","header-align":"center",align:"center",formatter:function(e){return t.formatNumber(e.AB)}}}),a("el-table-column",{attrs:{prop:"AO",label:"砂土CPT+黏土Su 需要压差/kPa","header-align":"center",align:"center",formatter:function(e){return t.formatNumber(e.AO)}}},[a("template",{slot:"header"},[a("span",{domProps:{innerHTML:t._s("砂土CPT+黏土Su<br> 需要压差/kPa")}})])],2),a("el-table-column",{attrs:{prop:"CK",label:"强度指标法 需要压差/kPa","header-align":"center",align:"center",formatter:function(e){return t.formatNumber(e.CK)}}},[a("template",{slot:"header"},[a("span",{domProps:{innerHTML:t._s("强度指标法 <br>需要压差/kPa")}})])],2)],1),a("el-table-column",{attrs:{label:"压差限值曲线","header-align":"center",align:"center"}},[a("el-table-column",{attrs:{prop:"BE",label:"砂土渗透+黏土土塞压差/kpa","header-align":"center",align:"center",width:"120",formatter:function(e){return t.formatNumber(e.BE)}}}),a("el-table-column",{attrs:{prop:"BF",label:"可用压差/kPa","header-align":"center",align:"center",width:"120",formatter:function(e){return t.formatNumber(e.BF)}}}),a("el-table-column",{attrs:{prop:"BG",label:"空化控制压差/kpa","header-align":"center",align:"center","min-width":"120",formatter:function(e){return t.formatNumber(e.BG)}}})],1)],1)],1),a("div",{staticStyle:{width:"100%",height:"600px","margin-top":"10px"},attrs:{id:"chartContainer"}}),a("div",{staticClass:"reference-link",on:{click:t.JumpToPdf}},[a("p",{staticClass:"reference-text"},[t._v("点击此处获取参数取值依据")])]),t.showPdf?a("PdfViewer",{attrs:{"pdf-name":t.pdfName},on:{close:function(e){t.showPdf=!1}}}):t._e()],1)},r=[],l=a("9608"),i=l["a"],o=a("2877"),s=Object(o["a"])(i,n,r,!1,null,null,null);e["default"]=s.exports},e9a3:function(t,e,a){"use strict";var n=function(){function t(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,a,n){return a&&t(e.prototype,a),n&&t(e,n),e}}();function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var l=a("99fa"),i=/[^.]+\.([^.]+)/,o={getPrefix:function(t){return"docx"===t?"word":"ppt"},getFileTypeName:function(t){return"docx"===t?"document":"presentation"},getRelsFileName:function(t){return t.replace(/^.*?([a-zA-Z0-9]+)\.xml$/,"$1")+".xml.rels"},getRelsFilePath:function(t,e){var a=o.getRelsFileName(t),n="pptx"===e?"ppt/slides":"word";return n+"/_rels/"+a}};t.exports=function(){function t(e,a,n,l){r(this,t),this.fileName=a,this.prefix=o.getPrefix(l),this.zip=e,this.xmlDocuments=n,this.fileTypeName=o.getFileTypeName(l),this.mediaPrefix="pptx"===l?"../media":"media";var i=o.getRelsFilePath(a,l);this.relsDoc=n[i]||this.createEmptyRelsDoc(n,i)}return n(t,[{key:"createEmptyRelsDoc",value:function(t,e){var a=this.prefix+"/_rels/"+this.fileTypeName+".xml.rels",n=t[a];if(!n){var r=new Error("Could not copy from empty relsdoc");throw r.properties={mainRels:a,relsFileName:e,files:Object.keys(this.zip.files)},r}for(var i=l.str2xml(l.xml2str(n)),o=i.getElementsByTagName("Relationships")[0],s=o.getElementsByTagName("Relationship"),c=0,u=s.length;c<u;c++)o.removeChild(s[c]);return t[e]=i,i}},{key:"loadImageRels",value:function(){var t=this.relsDoc.getElementsByTagName("Relationship");return Array.prototype.reduce.call(t,(function(t,e){var a=e.getAttribute("Id");return/^rId[0-9]+$/.test(a)?Math.max(t,parseInt(a.substr(3),10)):t}),0)}},{key:"addExtensionRels",value:function(t,e){var a=this.xmlDocuments["[Content_Types].xml"],n=a.getElementsByTagName("Default"),r=Array.prototype.some.call(n,(function(t){return t.getAttribute("Extension")===e}));if(!r){var l=a.getElementsByTagName("Types")[0],i=a.createElement("Default");i.namespaceURI=null,i.setAttribute("ContentType",t),i.setAttribute("Extension",e),l.appendChild(i)}}},{key:"addImageRels",value:function(t,e,a){null==a&&(a=0);var n=0===a?t:t+"("+a+")",r=this.prefix+"/media/"+n;if(null!=this.zip.files[r])return this.addImageRels(t,e,a+1);var l={name:r,data:e,options:{binary:!0}};this.zip.file(l.name,l.data,l.options);var o=n.replace(i,"$1");this.addExtensionRels("image/"+o,o);var s=this.relsDoc.getElementsByTagName("Relationships")[0],c=this.relsDoc.createElement("Relationship");c.namespaceURI=null;var u=this.loadImageRels()+1;return c.setAttribute("Id","rId"+u),c.setAttribute("Type","http://schemas.openxmlformats.org/officeDocument/2006/relationships/image"),c.setAttribute("Target",this.mediaPrefix+"/"+n),s.appendChild(c),u}}]),t}()}}]);