(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2e90a346","chunk-03e394b4"],{"0e4b":function(t,a,e){"use strict";e("492a")},1:function(t,a){},2:function(t,a){},3:function(t,a){},4:function(t,a){},"492a":function(t,a,e){},5:function(t,a){},"5e89":function(t,a,e){var l=e("861d"),i=Math.floor;t.exports=function(t){return!l(t)&&isFinite(t)&&i(t)===t}},6:function(t,a){},"6c8a":function(t,a,e){"use strict";e("b0c0"),e("e9c4"),e("b64b");a["a"]={created:function(){var t=this.$store.getters["pageCache/getPageData"](this.$options.name);t&&(Object.assign(this.$data,JSON.parse(JSON.stringify(t))),console.log("恢复缓存：".concat(this.$options.name)))},beforeRouteLeave:function(t,a,e){this.$store.commit("pageCache/saveTempPageData",{page:this.$options.name,data:JSON.parse(JSON.stringify(this.$data))}),console.log("离开页面缓存：".concat(this.$options.name)),e()}}},"81ec":function(t,a,e){"use strict";e.r(a);var l=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticStyle:{"background-color":"#f5f7fa",padding:"20px","border-radius":"8px"}},[e("div",{staticClass:"custom-card"},[e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData1,border:"",stripe:"","header-cell-style":{background:"#f5f7fa",color:"#4e4b4b",fontWeight:"bold"}}})],1),e("div",{staticClass:"custom-table-container1"},[e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.filteredTableData4,border:"",stripe:"","header-cell-style":{background:"#f5f7fa",color:"#4e4b4b",fontWeight:"bold"}}},[e("el-table-column",{attrs:{label:"抗滑承载力结果及安全系数（输出结果）","header-align":"center",align:"center"}},[e("el-table-column",{attrs:{prop:"B",label:"","header-align":"center",align:"center",formatter:function(a){return t.formatNumber(a.B)}}}),e("el-table-column",{attrs:{prop:"C",label:"","header-align":"center",align:"center",formatter:function(a){return t.formatNumber(a.C)}}}),e("el-table-column",{attrs:{prop:"D",label:"","header-align":"center",align:"center",formatter:function(a){return t.formatNumber(a.D)}}})],1)],1)],1),e("div",{staticClass:"reference-link",on:{click:t.JumpToPdf}},[e("p",{staticClass:"reference-text"},[t._v("点击此处获取参数取值依据")])]),t.showPdf?e("PdfViewer",{attrs:{"pdf-name":t.pdfName},on:{close:function(a){t.showPdf=!1}}}):t._e()],1)},i=[],s=e("c14f"),n=e("5530"),h=e("1da1"),r=e("b85c"),b=(e("4de4"),e("7db0"),e("d81d"),e("e9c4"),e("8ba4"),e("b680"),e("b64b"),e("d3b7"),e("ac1f"),e("25f0"),e("5319"),e("0643"),e("2382"),e("fffc"),e("a573"),e("cc45")),o=e("6c8a"),D={name:"PageE",components:{PdfViewer:b["default"]},mixins:[o["a"]],data:function(){return{showPdf:!1,pdfName:"",tableData1:[],tableData2:[],tableData3:[],tableData4:[{B:"筒型基础直径",C:null,D:"m",E:null,F:null},{B:"基础埋深",C:null,D:"m",E:null,F:null},{B:"滑移承载力",C:null,D:"kN",E:null,F:null},{B:"安全系数",C:null,D:null,E:null,F:null},{B:"桶重",C:null,D:"kN",E:null,F:null}],tableData:[{sheet1X16:null}],dialogVisible:!1,dialogVisible1:!1}},computed:{filteredTableData4:function(){return this.tableData4.filter((function(t){return"筒型基础直径"!==t.B&&"基础埋深"!==t.B}))}},mounted:function(){this.load(),this.change()},methods:{formatNumber:function(t){return"number"===typeof t?Number.isInteger(t)?t.toString():t.toFixed(3).replace(/\.?0+$/,""):t},excelVlookup:function(t,a,e){var l=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!a||!a.length)return null;if(e<1||e>a[0].length)throw new Error("列序号超出数据范围");if(!l){var i=a.find((function(a){return a[0]===t}));return i?i[e-1]:null}var s,n=null,h=Object(r["a"])(a);try{for(h.s();!(s=h.n()).done;){var b=s.value;if(b[0]===t)return b[e-1];b[0]<=t&&(!n||b[0]>n[0])&&(n=b)}}catch(o){h.e(o)}finally{h.f()}return n?n[e-1]:null},excelIndex:function(t,a,e){var l=Math.floor(a)-1;if(void 0===e)return t[l];var i=Math.floor(e)-1;return t[l][i]},change:function(){this.load()},load:function(){var t=sessionStorage.getItem("Demo2TableData1"),a=sessionStorage.getItem("dataTable");if(t&&a){for(var e=JSON.parse(t),l=JSON.parse(a),i=0;i<e.length;i++)this.tableData1[i]||(this.tableData1[i]={}),this.tableData1[i].B=e[i].A,this.tableData1[i].C=e[i].B,this.tableData1[i].D=e[i].C,this.tableData1[i].E=e[i].D,this.tableData1[i].F=e[i].E,this.tableData1[i].G=e[i].F,this.tableData1[i].H=e[i].G,this.tableData1[i].I=e[i].H,this.tableData1[i].J=e[i].I,this.tableData1[i].K=e[i].J,this.tableData1[i].L=e[i].K,this.tableData1[i].M=e[i].L,this.tableData1[i].N=e[i].M,this.tableData1[i].O=e[i].N;for(var s=sessionStorage.getItem("Demo2TableData2"),n=JSON.parse(s),h=n[0].C,r=n[1].C,b=0;b<this.tableData1.length;b++)this.tableData2[b]||(this.tableData2[b]={}),this.tableData2[b].B=this.tableData1[b].B,this.tableData2[b].D=this.tableData1[b].D,this.tableData2[b].E=this.tableData1[b].E,this.tableData2[b].F=this.tableData1[b].F,this.tableData2[b].G=this.tableData1[b].G,this.tableData2[b].H=this.tableData1[b].H,this.tableData2[b].I=180*Math.atan(Math.tan(this.tableData1[b].I*Math.PI/180)/h)/Math.PI,this.tableData2[b].J=this.tableData1[b].J/r,this.tableData2[b].K=this.tableData1[b].K/r,this.tableData2[b].L=this.tableData1[b].L/h,this.tableData2[b].M=this.tableData1[b].M,this.tableData2[b].O=this.tableData1[b].O;this.tableData2[0].C=0,this.tableData2[0].N=this.tableData2[0].H*(this.tableData2[0].D-this.tableData2[0].C);for(var o=1;o<this.tableData2.length;o++)this.tableData2[o].C=this.tableData2[o-1].D,this.tableData2[o].N=this.tableData2[o-1].N+this.tableData2[o].H*(this.tableData2[o].D-this.tableData2[o].C);console.log("传进来的sheet2大表",l);for(var D=0;D<l.length;D++)this.tableData3[D]||(this.tableData3[D]={}),this.tableData3[D].R=l[D][0],this.tableData3[D].S=l[D][1];var c=this.tableData1.map((function(t){return[t.B,t.C,t.D,t.E]})),u=this.tableData2.map((function(t){return[t.B,t.C,t.D,t.E,t.F,t.G,t.H]})),f=this.tableData2.map((function(t){return[t.B,t.C,t.D,t.E,t.F,t.G,t.H,t.I,t.J,t.K,t.L]})),d=this.tableData2.map((function(t){return[t.B,t.C,t.D,t.E,t.F,t.G,t.H,t.I,t.J,t.K,t.L,t.M]})),p=this.tableData2.map((function(t){return[t.B,t.C,t.D,t.E,t.F,t.G,t.H,t.I,t.J,t.K]})),g=this.tableData2.map((function(t){return[t.B,t.C,t.D]})),m=this.tableData2.map((function(t){return[t.B,t.C,t.D,t.E,t.F,t.G,t.H,t.I]})),A=sessionStorage.getItem("sheet1table4"),v=sessionStorage.getItem("sheet1table"),C=sessionStorage.getItem("arraysTable");if(A&&v&&C){var P=JSON.parse(A),N=JSON.parse(v),w=JSON.parse(C),S=P[0].A,x=sessionStorage.getItem("X16"),I=JSON.parse(x);this.tableData4[0].C=N[0].A,this.tableData4[0].F=1+(this.tableData4[0].C-10)/2,this.tableData4[1].C=N[0].E,this.tableData4[1].F=1+(this.tableData4[1].C-10)/2;for(var M=this.tableData4[0].C,O=this.tableData4[1].C,k=this.tableData4[4].C,F=0;F<this.tableData3.length;F++)this.tableData3[F].T=this.excelVlookup(this.tableData3[F].S,c,4),this.tableData3[F].U="砂土"===this.tableData3[F].T?0:1,this.tableData3[F].V=this.excelVlookup(this.tableData3[F].S,u,7),this.tableData3[F].W=this.excelVlookup(this.tableData3[F].S,f,11),this.tableData3[F].X=this.excelVlookup(this.tableData3[F].S,d,12),this.tableData3[F].Y=0===F?0:this.tableData3[F-1].Y+(this.tableData3[F].R-this.tableData3[F-1].R)*this.tableData3[F].V,this.tableData3[F].Z=0===F?0:(this.tableData3[F-1].Y+this.tableData3[F].Y)/2*this.tableData3[F].W,this.tableData3[F].AC=0===F?this.tableData2[0].J:this.excelVlookup(this.tableData3[F].S,p,9)+((this.tableData3[F].R+this.tableData3[F-1].R)/2-this.excelVlookup(this.tableData3[F].S,g,2))/(this.excelVlookup(this.tableData3[F].S,g,3)-this.excelVlookup(this.tableData3[F].S,g,2))*(this.excelVlookup(this.tableData3[F].S,p,10)-this.excelVlookup(this.tableData3[F].S,p,9)),this.tableData3[F].AD=0===F?0:this.tableData3[F].AC/this.tableData3[F].Y,this.tableData3[F].AE=Math.min(this.tableData3[F].AD>1?.5*Math.pow(this.tableData3[F].AD,-.25):.5*Math.pow(this.tableData3[F].AD,-.5),1),this.tableData3[F].AA=0===this.tableData3[F].U?this.tableData3[F].Z<this.tableData3[F].X?this.tableData3[F].Z:this.tableData3[F].X:this.tableData3[F].AC*this.tableData3[F].AE,this.tableData3[F].AB=0===F?0:this.tableData3[F].AA*(this.tableData3[F].R-this.tableData3[F-1].R)*Math.PI*M,this.tableData3[F].AF=0===F?this.tableData3[F].AB:this.tableData3[F-1].AF+this.tableData3[F].AB,this.tableData3[F].AG=this.excelVlookup(this.tableData3[F].S,m,8),this.tableData3[F].AH=0===F?0:M*(this.tableData3[F].R-this.tableData3[F-1].R)*(this.tableData3[F-1].Y+(this.tableData3[F].Y-this.tableData3[F-1].Y)/2+this.tableData3[F].AC+this.tableData3[F-1].AC),this.tableData3[F].AI=0===F?0:M*(this.tableData3[F].R-this.tableData3[F-1].R)*(this.tableData3[F-1].Y+(this.tableData3[F].Y-this.tableData3[F-1].Y)/2)*((1+Math.sin(this.tableData3[F].AG/180*Math.PI))/(1-Math.sin(this.tableData3[F].AG/180*Math.PI))-(1-Math.sin(this.tableData3[F].AG/180*Math.PI))/(1+Math.sin(this.tableData3[F].AG/180*Math.PI))),this.tableData3[F].AJ=0===F?0:0===this.tableData3[F].U?this.tableData3[F].AI:this.tableData3[F].AH,this.tableData3[F].AK=0===F?0:1===F?this.tableData3[F].AJ:this.tableData3[F-1].AK+this.tableData3[F].AJ,this.tableData3[F].AL=0===F?0:Math.PI*Math.pow(M,2)/4*(this.tableData3[F].R-this.tableData3[F-1].R)*this.tableData3[F].V,this.tableData3[F].AM=0===F?0:this.tableData3[F-1].AM+this.tableData3[F].AL,this.tableData3[F].AN=.9*(k+3.14*Math.pow(M,2)/4*this.tableData3[F].Y)-S-this.tableData3[F].AF>0?.9*(k+3.14*Math.pow(M,2)/4*this.tableData3[F].Y)-S-this.tableData3[F].AF:0,this.tableData3[F].AO=Math.PI*Math.pow(M,2)/4*this.tableData3[F].AC,this.tableData3[F].AP=this.tableData3[F].AN*Math.tan(this.tableData3[F].AG/180*Math.PI),this.tableData3[F].AQ=0===this.tableData3[F].U?this.tableData3[F].AP:this.tableData3[F].AO,this.tableData3[F].AR=this.tableData3[F].AK+this.tableData3[F].AQ;var J=this.tableData3.map((function(t){return[t.R,t.S,t.T,t.U,t.V,t.W,t.X,t.Y,t.Z,t.AA,t.AB,t.AC,t.AD,t.AE,t.AF,t.AG,t.AH,t.AI,t.AJ,t.AK,t.AL,t.AM,t.AN,t.AO,t.AP,t.AQ,t.AR]}));this.tableData4[2].C=this.excelVlookup(O,J,27),this.tableData[0].sheet1X16=I,this.tableData4[3].C=this.tableData4[2].C/I,this.tableData4[4].C=this.excelIndex(w,this.tableData4[1].F,this.tableData4[0].F),this.handleExportWord()}else this.$alert("未获取到1.竖向承载力校核_荷载计算页面的数据","提示",{confirmButtonText:"确定",type:"warning"})}else this.$alert("未获取到2.上拔承载力页面的数据","提示",{confirmButtonText:"确定",type:"warning"})},handleExportWord:function(){var t=this;return Object(h["a"])(Object(s["a"])().m((function a(){var e,l,i,h;return Object(s["a"])().w((function(a){while(1)switch(a.n){case 0:for(h in e={},e["5_4_C49"]=t.tableData4[2].C,e["5_4_C50"]=t.tableData4[3].C,e["5_4_Fxy"]=t.tableData[0].sheet1X16,l=Object(n["a"])({},e),i={},l)i[h]=t.formatNumber(l[h]);sessionStorage.setItem("1_sheet5",JSON.stringify(i)),console.log("第五个页面存数据over");case 1:return a.a(2)}}),a)})))()},JumpToPdf:function(){console.log("pdf跳转"),this.pdfName="1",this.showPdf=!0}}},c=D,u=e("2877"),f=Object(u["a"])(c,l,i,!1,null,null,null);a["default"]=f.exports},"8ba4":function(t,a,e){var l=e("23e7"),i=e("5e89");l({target:"Number",stat:!0},{isInteger:i})},cc45:function(t,a,e){"use strict";e.r(a);var l=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"pdf-viewer"},[e("div",{staticClass:"controls"},[e("button",{attrs:{disabled:t.pageNum<=1},on:{click:t.prevPage}},[t._v("上一页")]),e("span",[t._v("第 "+t._s(t.pageNum)+" / "+t._s(t.totalPages)+" 页")]),e("button",{attrs:{disabled:t.pageNum>=t.totalPages},on:{click:t.nextPage}},[t._v("下一页")]),e("button",{on:{click:t.zoomOut}},[t._v("缩小")]),e("span",[t._v("缩放: "+t._s((100*t.scale).toFixed(0))+"%")]),e("button",{on:{click:t.zoomIn}},[t._v("放大")]),e("button",{on:{click:function(a){return t.$emit("close")}}},[t._v("关闭")])]),e("canvas",{ref:"pdfCanvas"})])},i=[],s=e("c14f"),n=e("1da1"),h=e("f9cb"),r=e("8658"),b=e.n(r);h["GlobalWorkerOptions"].workerSrc=b.a;var o={name:"PdfViewer",props:{pdfName:{type:String,required:!0}},data:function(){return{pdfDoc:null,pageNum:1,totalPages:0,scale:1}},watch:{pdfName:"loadPdf"},mounted:function(){this.loadPdf()},methods:{loadPdf:function(){var t=this;return Object(n["a"])(Object(s["a"])().m((function a(){var e,l;return Object(s["a"])().w((function(a){while(1)switch(a.p=a.n){case 0:return e="/pdf/".concat(t.pdfName,".pdf"),a.p=1,a.n=2,h["getDocument"](e).promise;case 2:t.pdfDoc=a.v,t.totalPages=t.pdfDoc.numPages,t.pageNum=1,t.renderPage(),a.n=4;break;case 3:a.p=3,l=a.v,console.error("加载 PDF 出错:",l);case 4:return a.a(2)}}),a,null,[[1,3]])})))()},renderPage:function(){var t=this;return Object(n["a"])(Object(s["a"])().m((function a(){var e,l,i,n,h;return Object(s["a"])().w((function(a){while(1)switch(a.n){case 0:return a.n=1,t.pdfDoc.getPage(t.pageNum);case 1:return e=a.v,l=e.getViewport({scale:t.scale}),i=t.$refs.pdfCanvas,n=i.getContext("2d"),i.height=l.height,i.width=l.width,h={canvasContext:n,viewport:l},a.n=2,e.render(h).promise;case 2:return a.a(2)}}),a)})))()},prevPage:function(){this.pageNum>1&&(this.pageNum--,this.renderPage())},nextPage:function(){this.pageNum<this.totalPages&&(this.pageNum++,this.renderPage())},zoomIn:function(){this.scale+=.2,this.renderPage()},zoomOut:function(){this.scale>.4&&(this.scale-=.2,this.renderPage())}}},D=o,c=(e("0e4b"),e("2877")),u=Object(c["a"])(D,l,i,!1,null,"73facc5c",null);a["default"]=u.exports}}]);